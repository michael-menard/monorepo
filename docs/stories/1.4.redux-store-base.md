# Story 1.4: Redux Store Base

## Status

Approved

## Story

**As a** developer,
**I want** a Redux Toolkit store configured with DevTools,
**so that** I have centralized state management for the shell app.

## Acceptance Criteria

1. ✅ Redux Toolkit store created with configureStore
2. ✅ Redux DevTools enabled for development
3. ✅ Typed hooks (useAppDispatch, useAppSelector) exported
4. ✅ RootState and AppDispatch types exported
5. ⬜ Store configured for slice injection (dynamic reducers)
6. ⬜ RTK Query middleware configured
7. ⬜ Store wrapped in Provider in App.tsx

## Tasks / Subtasks

- [ ] **Task 1: Verify Store Configuration** (AC: 1-4)
  - [x] Check store uses configureStore from RTK
  - [x] Verify DevTools are enabled
  - [ ] Confirm typed hooks in hooks.ts
  - [ ] Verify RootState type is exported

- [ ] **Task 2: Verify Slice Injection** (AC: 5)
  - [ ] Check if combineReducers supports injection
  - [ ] Document pattern for domain apps to inject reducers

- [ ] **Task 3: Verify RTK Query Setup** (AC: 6)
  - [ ] Confirm API middleware is added
  - [ ] Check setupListeners is called for refetch behaviors

- [ ] **Task 4: Verify Provider Setup** (AC: 7)
  - [ ] Confirm <Provider store={store}> wraps app
  - [ ] Check store is imported correctly

## Dev Notes

### Existing Implementation

**File:** `apps/web/main-app/src/store/index.ts`

**File:** `apps/web/main-app/src/store/hooks.ts`

- Should export useAppDispatch, useAppSelector

### Store Structure

[Source: docs/architecture/coding-standards.md#state-management-with-redux-toolkit]

```typescript
import { configureStore } from '@reduxjs/toolkit'
import { setupListeners } from '@reduxjs/toolkit/query'

export const store = configureStore({
  reducer: {
    auth: authReducer,
    theme: themeReducer,
    // API slices will be injected
  },
  middleware: getDefaultMiddleware => getDefaultMiddleware().concat(api.middleware),
})

setupListeners(store.dispatch)

export type RootState = ReturnType<typeof store.getState>
export type AppDispatch = typeof store.dispatch
```

### Typed Hooks

```typescript
import { useDispatch, useSelector } from 'react-redux'
import type { RootState, AppDispatch } from './store'

export const useAppDispatch = useDispatch.withTypes<AppDispatch>()
export const useAppSelector = useSelector.withTypes<RootState>()
```

### Testing

- Import store and verify it's configured
- Test typed hooks work in a component
- Verify DevTools appear in browser

## Change Log

| Date       | Version | Description                             | Author   |
| ---------- | ------- | --------------------------------------- | -------- |
| 2025-11-28 | 0.1     | Initial draft - brownfield verification | SM Agent |
