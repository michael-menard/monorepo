# Story 3.0.4: Gallery Search Component

## Status

Draft

## Story

**As a** user,
**I want** to search gallery items by text,
**so that** I can quickly find specific items.

## Acceptance Criteria

1. ⬜ GallerySearch component created in @repo/gallery
2. ⬜ Debounced input (300ms default) to prevent excessive API calls
3. ⬜ Clear button appears when text is entered
4. ⬜ Search icon visual indicator
5. ⬜ Accessible with proper label and ARIA attributes
6. ⬜ Controlled and uncontrolled usage patterns supported

## Tasks / Subtasks

- [ ] **Task 1: Create Search Component**
  - [ ] Create `src/components/GallerySearch.tsx`
  - [ ] Use @repo/ui Input as foundation
  - [ ] Add search icon (lucide-react)

- [ ] **Task 2: Debounce Logic**
  - [ ] Create `useDebounce` hook or use existing
  - [ ] Default 300ms debounce delay
  - [ ] Configurable delay via prop

- [ ] **Task 3: Clear Functionality**
  - [ ] Show X button when value present
  - [ ] Clear on button click
  - [ ] Clear on Escape key

- [ ] **Task 4: Accessibility**
  - [ ] aria-label for search input
  - [ ] aria-describedby for help text if provided
  - [ ] role="searchbox"

## Dev Notes

### Component API

```typescript
interface GallerySearchProps {
  value?: string
  defaultValue?: string
  onChange: (value: string) => void
  onSearch?: (value: string) => void  // Called after debounce
  placeholder?: string  // default: "Search..."
  debounceMs?: number   // default: 300
  className?: string
}

// Controlled usage
const [search, setSearch] = useState('')
<GallerySearch
  value={search}
  onChange={setSearch}
  onSearch={handleDebouncedSearch}
  placeholder="Search instructions..."
/>

// Uncontrolled usage
<GallerySearch
  onSearch={handleSearch}
/>
```

### useDebounce Hook

```typescript
function useDebounce<T>(value: T, delay: number): T {
  const [debouncedValue, setDebouncedValue] = useState(value)

  useEffect(() => {
    const timer = setTimeout(() => setDebouncedValue(value), delay)
    return () => clearTimeout(timer)
  }, [value, delay])

  return debouncedValue
}
```

## Testing

- [ ] Unit test: onChange fires immediately
- [ ] Unit test: onSearch fires after debounce delay
- [ ] Unit test: clear button resets value
- [ ] Unit test: Escape key clears input
- [ ] Accessibility test: proper ARIA attributes

## Change Log

| Date       | Version | Description   | Author   |
| ---------- | ------- | ------------- | -------- |
| 2025-11-30 | 0.1     | Initial draft | SM Agent |
