# Story 2.3: Initial Grafana Dashboards Creation

## Status

Draft

## Story

**As a** Engineering Team Member,
**I want** initial Grafana dashboards for Lambda, API Gateway, and CloudFront performance,
**so that** I can monitor application health from launch.

## Acceptance Criteria

1. **Lambda Performance Dashboard** created with panels for: invocations, duration (p50/p95/p99), errors, throttles, cold starts, concurrent executions
2. **API Gateway Dashboard** created with panels for: request count, latency (p50/p95/p99), 4xx errors, 5xx errors, by route/method
3. **CloudFront Dashboard** created with panels for: requests, cache hit ratio, bytes downloaded, error rates, edge location distribution
4. **System Health Dashboard** created with panels for: Aurora connections, CPU, S3 storage metrics, ECS task health (when added)
5. All dashboards use appropriate time ranges and refresh intervals
6. Dashboards organized into folders (Infrastructure, Application, Frontend)

**Integration Verification:**

- IV1: Dashboards display existing application metrics correctly
- IV2: Historical data (if any) visible in dashboard queries
- IV3: Dashboard refresh doesn't cause excessive CloudWatch API calls

## Tasks / Subtasks

- [ ] **Task 1: Create dashboard folder structure** (AC: 6)
  - [ ] Create folder: "Infrastructure" for system-level dashboards
  - [ ] Create folder: "Application" for Lambda and API Gateway dashboards
  - [ ] Create folder: "Frontend" for CloudFront and user-facing metrics
  - [ ] Set appropriate permissions for each folder (admin/viewer access)
  - [ ] Document folder organization and naming conventions

- [ ] **Task 2: Create Lambda Performance Dashboard** (AC: 1, 5)
  - [ ] Create new dashboard: "Lambda Performance" in Application folder
  - [ ] Add panel: Lambda Invocations (sum by function name)
  - [ ] Add panel: Lambda Duration (p50, p95, p99 percentiles by function)
  - [ ] Add panel: Lambda Errors (count and error rate by function)
  - [ ] Add panel: Lambda Throttles (count by function)
  - [ ] Add panel: Lambda Cold Starts (custom metric when available)
  - [ ] Add panel: Lambda Concurrent Executions (max by function)
  - [ ] Configure time range: Last 6 hours, auto-refresh every 1 minute
  - [ ] Add variables for function name filtering

- [ ] **Task 3: Create API Gateway Dashboard** (AC: 2, 5)
  - [ ] Create new dashboard: "API Gateway Performance" in Application folder
  - [ ] Add panel: Request Count (sum by API and method)
  - [ ] Add panel: Request Latency (p50, p95, p99 by API and route)
  - [ ] Add panel: 4xx Error Rate (percentage by API and method)
  - [ ] Add panel: 5xx Error Rate (percentage by API and method)
  - [ ] Add panel: Request Count by Route (top 10 routes)
  - [ ] Add panel: Error Count by Route (top error-prone routes)
  - [ ] Configure time range: Last 6 hours, auto-refresh every 1 minute
  - [ ] Add variables for API name and method filtering

- [ ] **Task 4: Create CloudFront Dashboard** (AC: 3, 5)
  - [ ] Create new dashboard: "CloudFront Performance" in Frontend folder
  - [ ] Add panel: CloudFront Requests (total requests over time)
  - [ ] Add panel: Cache Hit Ratio (percentage over time)
  - [ ] Add panel: Bytes Downloaded (total and by content type)
  - [ ] Add panel: Error Rates (4xx and 5xx error percentages)
  - [ ] Add panel: Edge Location Distribution (requests by edge location)
  - [ ] Add panel: Origin Response Time (latency from origin)
  - [ ] Configure time range: Last 24 hours, auto-refresh every 5 minutes
  - [ ] Add variables for distribution ID filtering

- [ ] **Task 5: Create System Health Dashboard** (AC: 4, 5)
  - [ ] Create new dashboard: "System Health" in Infrastructure folder
  - [ ] Add panel: Aurora Database Connections (active connections)
  - [ ] Add panel: Aurora CPU Utilization (percentage over time)
  - [ ] Add panel: Aurora Freeable Memory (available memory)
  - [ ] Add panel: ElastiCache Redis Memory Usage (used memory percentage)
  - [ ] Add panel: OpenSearch Cluster Health (cluster status)
  - [ ] Add panel: S3 Storage Metrics (bucket sizes and request counts)
  - [ ] Add panel: ECS Task Health (placeholder for future Phase 4)
  - [ ] Configure time range: Last 12 hours, auto-refresh every 2 minutes

- [ ] **Task 6: Configure dashboard settings and optimization** (AC: 5, IV3)
  - [ ] Set appropriate refresh intervals to minimize API calls
  - [ ] Configure dashboard time ranges based on metric types
  - [ ] Set up dashboard variables for filtering and drill-down
  - [ ] Configure panel legends and tooltips for clarity
  - [ ] Set up appropriate alert thresholds on key panels
  - [ ] Optimize query intervals to reduce CloudWatch API usage
  - [ ] Test dashboard performance and loading times

- [ ] **Task 7: Validate dashboards and integration** (AC: 1-6, IV1-IV3)
  - [ ] Verify all dashboards display metrics correctly
  - [ ] Test dashboard filtering and variable functionality
  - [ ] Validate historical data appears in time series panels
  - [ ] Confirm dashboard refresh doesn't exceed CloudWatch API limits
  - [ ] Test dashboard access for admin and viewer roles
  - [ ] Verify existing CloudWatch dashboard remains functional
  - [ ] Document any missing metrics or data gaps

- [ ] **Task 8: Create dashboard documentation and sharing** (AC: 1-6)
  - [ ] Create documentation for each dashboard and its purpose
  - [ ] Document panel configurations and metric queries
  - [ ] Create user guide for dashboard navigation and filtering
  - [ ] Share dashboard URLs with Product, Engineering, and CS teams
  - [ ] Create troubleshooting guide for common dashboard issues
  - [ ] Document dashboard maintenance and update procedures
