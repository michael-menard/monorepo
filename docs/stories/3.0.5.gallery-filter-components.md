# Story 3.0.5: Gallery Filter Components

## Status

Draft

## Story

**As a** user,
**I want** to filter gallery items by tags and themes,
**so that** I can narrow down results to what I'm looking for.

## Acceptance Criteria

1. ⬜ GalleryTagFilter component for tag selection
2. ⬜ GalleryThemeFilter component for theme dropdown
3. ⬜ Multi-select support for tags (pills/chips display)
4. ⬜ Single-select for theme dropdown
5. ⬜ Clear all filters option
6. ⬜ Filter state managed via props (controlled)
7. ⬜ Accessible dropdowns with keyboard navigation

## Tasks / Subtasks

- [ ] **Task 1: Tag Filter Component**
  - [ ] Create `src/components/GalleryTagFilter.tsx`
  - [ ] Use @repo/ui MultiSelect or Popover+Checkbox
  - [ ] Display selected tags as removable pills

- [ ] **Task 2: Theme Filter Component**
  - [ ] Create `src/components/GalleryThemeFilter.tsx`
  - [ ] Use @repo/ui Select component
  - [ ] Include "All Themes" option

- [ ] **Task 3: Filter Pills Display**
  - [ ] Create `src/components/GalleryActiveFilters.tsx`
  - [ ] Show all active filters as removable badges
  - [ ] "Clear All" button when filters active

- [ ] **Task 4: Filter Bar Container**
  - [ ] Create `src/components/GalleryFilterBar.tsx`
  - [ ] Compose search, tags, theme, sort together
  - [ ] Responsive layout (stack on mobile)

## Dev Notes

### Component APIs

```typescript
// Tag Filter
interface GalleryTagFilterProps {
  tags: string[]           // Available tags
  selected: string[]       // Currently selected
  onChange: (tags: string[]) => void
  placeholder?: string     // default: "Filter by tags"
}

// Theme Filter
interface GalleryThemeFilterProps {
  themes: string[]         // Available themes
  selected: string | null  // Currently selected
  onChange: (theme: string | null) => void
  placeholder?: string     // default: "All Themes"
}

// Active Filters Display
interface GalleryActiveFiltersProps {
  filters: Array<{ key: string; value: string; label: string }>
  onRemove: (key: string, value: string) => void
  onClearAll: () => void
}

// Combined Filter Bar
interface GalleryFilterBarProps {
  search: string
  onSearchChange: (value: string) => void
  tags: string[]
  selectedTags: string[]
  onTagsChange: (tags: string[]) => void
  themes: string[]
  selectedTheme: string | null
  onThemeChange: (theme: string | null) => void
  sortOptions: SortOption[]
  selectedSort: string
  onSortChange: (sort: string) => void
}
```

### Usage Example

```typescript
<GalleryFilterBar
  search={search}
  onSearchChange={setSearch}
  tags={availableTags}
  selectedTags={selectedTags}
  onTagsChange={setSelectedTags}
  themes={availableThemes}
  selectedTheme={selectedTheme}
  onThemeChange={setSelectedTheme}
  sortOptions={sortOptions}
  selectedSort={sortBy}
  onSortChange={setSortBy}
/>
```

## Testing

- [ ] Unit test: tag selection adds/removes from selected array
- [ ] Unit test: theme selection updates single value
- [ ] Unit test: clear all resets all filters
- [ ] Unit test: pills display correct labels
- [ ] Accessibility test: keyboard navigation in dropdowns

## Change Log

| Date       | Version | Description   | Author   |
| ---------- | ------- | ------------- | -------- |
| 2025-11-30 | 0.1     | Initial draft | SM Agent |
