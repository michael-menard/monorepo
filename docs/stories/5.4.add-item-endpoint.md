# Story 5.4: Add Item Endpoint

## Status

Approved

## Story

**As a** user,
**I want** to add items to my wishlist,
**so that** I can track what I want.

## Acceptance Criteria

1. â¬œ `useAddWishlistItemMutation` hook available
2. â¬œ POST /wishlist with item data
3. â¬œ Returns created item
4. â¬œ Optimistic update
5. ðŸ”„ Backend: POST /wishlist endpoint required

## Tasks / Subtasks

- [ ] **Task 1: Define Mutation**
  - [ ] Add addWishlistItem mutation
  - [ ] Configure optimistic update

## Dev Notes

```typescript
addWishlistItem: builder.mutation<WishlistItem, CreateWishlistItemInput>({
  query: (data) => ({
    url: '/wishlist',
    method: 'POST',
    body: data,
  }),
  invalidatesTags: ['WishlistItems'],
  async onQueryStarted(data, { dispatch, queryFulfilled }) {
    // Optimistic update
    const patchResult = dispatch(
      wishlistApi.util.updateQueryData('getWishlist', undefined, (draft) => {
        draft.push({ ...data, id: 'temp', createdAt: new Date().toISOString() })
      })
    )
    try {
      await queryFulfilled
    } catch {
      patchResult.undo()
    }
  },
}),

interface CreateWishlistItemInput {
  name: string
  url: string
  type: 'moc' | 'lego' | 'alt'
  notes?: string
}
```

## Change Log

| Date       | Version | Description   | Author   |
| ---------- | ------- | ------------- | -------- |
| 2025-11-28 | 0.1     | Initial draft | SM Agent |
