# Story 4.15: Save MOC (Create)

## Status

Approved

## Story

**As a** user,
**I want** to save my new MOC,
**so that** it's added to my collection.

## Acceptance Criteria

1. ⬜ Save button submits form
2. ⬜ Validation runs before submit
3. ⬜ Creates MOC via API
4. ⬜ Uploads cover image if provided
5. ⬜ Shows success toast
6. ⬜ Redirects to MOC detail

## Tasks / Subtasks

- [ ] **Task 1: Submit Handler**
  - [ ] Validate form
  - [ ] Call createMoc mutation
  - [ ] Handle file upload

- [ ] **Task 2: Success Flow**
  - [ ] Show toast notification
  - [ ] Navigate to detail page

## Dev Notes

```typescript
function MocForm({ onSuccess }: MocFormProps) {
  const form = useForm<MocFormValues>({
    resolver: zodResolver(mocFormSchema),
    defaultValues: { title: '', description: '', theme: '', tags: [] },
  })

  const [createMoc, { isLoading }] = useCreateMocMutation()
  const [uploadFile] = useUploadFileMutation()

  const onSubmit = async (values: MocFormValues) => {
    try {
      const moc = await createMoc(values).unwrap()

      if (coverImage) {
        await uploadFile({ mocId: moc.id, file: coverImage }).unwrap()
      }

      toast.success('MOC created successfully!')
      onSuccess(moc)
    } catch (error) {
      toast.error('Failed to create MOC')
    }
  }

  return (
    <Form {...form}>
      <form onSubmit={form.handleSubmit(onSubmit)}>
        {/* Form fields */}
        <Button type="submit" disabled={isLoading}>
          {isLoading ? <Spinner /> : 'Save MOC'}
        </Button>
      </form>
    </Form>
  )
}
```

## Change Log

| Date       | Version | Description   | Author   |
| ---------- | ------- | ------------- | -------- |
| 2025-11-28 | 0.1     | Initial draft | SM Agent |
