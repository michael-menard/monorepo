# Story 1.7: Global UI Slice

## Status

Ready for Review

## Story

**As a** developer,
**I want** a globalUISlice for sidebar state and loading flags,
**so that** UI state is centralized and consistent.

## Acceptance Criteria

1. ✅ globalUISlice created with createSlice
2. ✅ Sidebar state: isOpen, isCollapsed
3. ✅ Loading flags: isNavigating, isPageLoading
4. ✅ Modal state: activeModal, modalProps
5. ✅ Actions: toggleSidebar, setSidebarOpen, setNavigating, openModal, closeModal
6. ✅ Selectors for all state properties
7. ✅ Integrated into store

## Tasks / Subtasks

- [x] **Task 1: Check for Existing Implementation**
  - [x] Search for globalUISlice or similar
  - [x] Check navigationSlice for related state
  - [x] Document what exists vs needs creation

- [x] **Task 2: Create or Enhance Slice** (AC: 1-5)
  - [x] Create globalUISlice if not exists
  - [x] Add sidebar state (isOpen, isCollapsed)
  - [x] Add loading flags (isNavigating, isPageLoading)
  - [x] Add modal state (activeModal, modalProps)
  - [x] Export all actions

- [x] **Task 3: Create Selectors** (AC: 6)
  - [x] selectSidebarOpen
  - [x] selectSidebarCollapsed
  - [x] selectIsNavigating
  - [x] selectActiveModal

- [x] **Task 4: Integrate into Store** (AC: 7)
  - [x] Add reducer to store configuration
  - [x] Verify RootState type includes globalUI

## Dev Notes

### Existing Related Code

**File:** `apps/web/main-app/src/store/slices/navigationSlice.ts`

May contain some of this functionality. Need to check.

### Proposed State Shape

```typescript
interface GlobalUIState {
  sidebar: {
    isOpen: boolean
    isCollapsed: boolean
  }
  loading: {
    isNavigating: boolean
    isPageLoading: boolean
  }
  modal: {
    activeModal: string | null
    modalProps: Record<string, unknown>
  }
}
```

### Actions

- toggleSidebar()
- setSidebarOpen(boolean)
- setSidebarCollapsed(boolean)
- setNavigating(boolean)
- setPageLoading(boolean)
- openModal(name, props)
- closeModal()

### Integration Points

- Sidebar component reads isOpen, isCollapsed
- Page transitions set isNavigating
- Modal system uses activeModal, modalProps

### Testing

- Unit test each action
- Test sidebar toggle logic
- Test modal open/close flow

## Dev Agent Record

### Agent Model Used

Claude Opus 4.5 (claude-opus-4-5-20251101)

### File List

| File                                                                 | Action   |
| -------------------------------------------------------------------- | -------- |
| `apps/web/main-app/src/store/slices/globalUISlice.ts`                | Created  |
| `apps/web/main-app/src/store/slices/__tests__/globalUISlice.test.ts` | Created  |
| `apps/web/main-app/src/store/index.ts`                               | Modified |

### Completion Notes

1. Created new `globalUISlice` with full state management for sidebar, loading, and modal states
2. Implemented all required actions including bonus actions: `toggleSidebarCollapsed`, `setPageLoading`, `resetGlobalUI`
3. Created 10 selectors including computed selector `selectIsLoading`
4. Integrated into store - RootState now includes `globalUI` slice
5. Comprehensive test coverage: 28 tests covering all actions and selectors

### Debug Log References

None - implementation was straightforward.

## Change Log

| Date       | Version | Description                           | Author            |
| ---------- | ------- | ------------------------------------- | ----------------- |
| 2025-11-28 | 0.1     | Initial draft - may need creation     | SM Agent          |
| 2025-11-28 | 1.0     | Implementation complete - all ACs met | Dev Agent (James) |
