# Story 1.32: Page Transition Spinner

## Status

Approved

## Story

**As a** user,
**I want** a loading spinner during page transitions,
**so that** I know the app is loading a new page.

## Acceptance Criteria

1. ⬜ PageTransitionSpinner component created
2. ⬜ Shows when isNavigating is true
3. ⬜ Positioned at top of page (progress bar style)
4. ⬜ Or centered overlay spinner
5. ⬜ Smooth fade-in animation
6. ⬜ LEGO brand colors

## Tasks / Subtasks

- [ ] **Task 1: Create Spinner Component** (AC: 1)
  - [ ] Create components/PageTransitionSpinner.tsx
  - [ ] Accept variant prop (bar vs overlay)

- [ ] **Task 2: Progress Bar Style** (AC: 3)
  - [ ] Fixed position at top
  - [ ] Animated width (indeterminate)
  - [ ] Use primary color (red)

- [ ] **Task 3: Overlay Style** (AC: 4)
  - [ ] Optional centered overlay
  - [ ] Semi-transparent backdrop
  - [ ] Spinning LEGO brick

- [ ] **Task 4: Animation & Styling** (AC: 5-6)
  - [ ] Fade in on show
  - [ ] Use brand colors
  - [ ] Don't block interaction

- [ ] **Task 5: Connect to State** (AC: 2)
  - [ ] Use selectIsNavigating or router state
  - [ ] Render conditionally

## Dev Notes

### Component Options

#### Option A: Progress Bar (Recommended)

```typescript
export function PageTransitionSpinner() {
  const isNavigating = useRouterState({ select: s => s.isLoading })

  if (!isNavigating) return null

  return (
    <div className="fixed top-0 left-0 right-0 z-50 h-1">
      <motion.div
        className="h-full bg-primary"
        initial={{ width: '0%' }}
        animate={{ width: '90%' }}
        transition={{ duration: 0.5, ease: 'easeOut' }}
      />
    </div>
  )
}
```

#### Option B: NProgress Style

```typescript
import NProgress from 'nprogress'
import 'nprogress/nprogress.css'

// Configure
NProgress.configure({ showSpinner: false })

// In route change effect
useEffect(() => {
  if (isNavigating) {
    NProgress.start()
  } else {
    NProgress.done()
  }
}, [isNavigating])
```

#### Option C: Overlay Spinner

```typescript
export function PageTransitionOverlay() {
  const isNavigating = useRouterState({ select: s => s.isLoading })

  return (
    <AnimatePresence>
      {isNavigating && (
        <motion.div
          initial={{ opacity: 0 }}
          animate={{ opacity: 1 }}
          exit={{ opacity: 0 }}
          className="fixed inset-0 bg-background/50 z-50 flex items-center justify-center"
        >
          <Loader2 className="h-8 w-8 animate-spin text-primary" />
        </motion.div>
      )}
    </AnimatePresence>
  )
}
```

### Integration in Layout

```typescript
// In RootLayout.tsx
function RootLayout() {
  return (
    <>
      <PageTransitionSpinner />
      <Header />
      <Sidebar />
      <main>
        <Outlet />
      </main>
    </>
  )
}
```

### CSS for Custom Progress Bar

```css
@keyframes progress-indeterminate {
  0% {
    transform: translateX(-100%);
  }
  100% {
    transform: translateX(400%);
  }
}

.progress-bar {
  animation: progress-indeterminate 1.5s ease infinite;
}
```

### Testing

- Test spinner shows during navigation
- Test spinner hides after navigation
- Test animation is smooth
- Visual test styling

## Change Log

| Date       | Version | Description   | Author   |
| ---------- | ------- | ------------- | -------- |
| 2025-11-28 | 0.1     | Initial draft | SM Agent |
