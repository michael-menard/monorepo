# Story insp-1027: Remove from Album UI

## Status

Draft

## Story

**As a** user,
**I want** to remove an inspiration from the current album,
**so that** I can reorganize my collections quickly.

## Acceptance Criteria

1. "Remove from album" action available when viewing within album context
2. Action appears in card context menu in album view
3. Action appears in detail view when accessed from album
4. Confirmation if this is the inspiration's last album
5. Removes from album without deleting inspiration
6. Gallery refreshes after removal

## Tasks / Subtasks

- [ ] **Task 1: Add Context Menu Action** (AC: 1, 2)
  - [ ] Add context menu to InspirationCard in album view
  - [ ] Include "Remove from album" option
  - [ ] Pass albumId context

- [ ] **Task 2: Add Detail View Action** (AC: 3)
  - [ ] Add "Remove from this album" button in detail view
  - [ ] Only show when accessed from album context
  - [ ] Track album context in route/state

- [ ] **Task 3: Implement Confirmation** (AC: 4)
  - [ ] Check if inspiration is only in this album
  - [ ] Show confirmation modal if last album
  - [ ] Warn that it will become orphaned

- [ ] **Task 4: Handle Removal** (AC: 5, 6)
  - [ ] Call remove mutation
  - [ ] Invalidate album contents query
  - [ ] Show success toast
  - [ ] Stay in album view (don't navigate)

## Dev Notes

### Context Menu in Album View

```tsx
function InspirationCard({ inspiration, albumContext }) {
  const [removeFromAlbum] = useRemoveFromAlbumMutation()

  return (
    <ContextMenu>
      <ContextMenuTrigger>
        <Card>{/* Card content */}</Card>
      </ContextMenuTrigger>
      <ContextMenuContent>
        {albumContext && (
          <ContextMenuItem
            onClick={() => handleRemoveFromAlbum(albumContext.albumId)}
          >
            <Minus className="w-4 h-4 mr-2" />
            Remove from {albumContext.albumTitle}
          </ContextMenuItem>
        )}
        <ContextMenuItem>
          <FolderPlus className="w-4 h-4 mr-2" />
          Add to album...
        </ContextMenuItem>
        <ContextMenuSeparator />
        <ContextMenuItem className="text-destructive">
          <Trash className="w-4 h-4 mr-2" />
          Delete permanently
        </ContextMenuItem>
      </ContextMenuContent>
    </ContextMenu>
  )
}
```

### Album Context Tracking
Pass album context through route or component props when navigating from album to detail view:

```tsx
// In album view
<InspirationCard
  inspiration={item}
  albumContext={{ albumId: album.id, albumTitle: album.title }}
/>

// Or via route state
navigate({
  to: '/inspiration/$id',
  params: { id: item.id },
  state: { fromAlbum: { id: album.id, title: album.title } }
})
```

### Last Album Confirmation

```tsx
function handleRemove() {
  if (inspiration.albumIds.length === 1) {
    // Show confirmation modal
    setShowOrphanWarning(true)
  } else {
    // Remove directly
    removeFromAlbum({ albumId, inspirationId })
  }
}
```

### Dependencies
- insp-1026: Remove from Album Endpoint

## Testing

- [ ] Context menu shows in album view
- [ ] "Remove from album" removes item
- [ ] Detail view shows remove action in album context
- [ ] Confirmation shown when last album
- [ ] Inspiration still exists after removal
- [ ] Album view refreshes

## Change Log

| Date       | Version | Description   | Author   |
| ---------- | ------- | ------------- | -------- |
| 2025-12-27 | 0.1     | Initial draft | SM Agent |
