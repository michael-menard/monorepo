# Story insp-1031: "Create as Album?" Flow

## Status

Draft

## Story

**As a** user,
**I want** to be prompted to create an album when uploading multiple images,
**so that** I can organize related images together immediately.

## Acceptance Criteria

1. When uploading 2+ images, show "Create as album?" prompt
2. Prompt appears after successful uploads complete
3. User can enter album name
4. "Create Album" adds all uploaded images to new album
5. "Add individually" skips album creation
6. Album gets first image as cover

## Tasks / Subtasks

- [ ] **Task 1: Detect Multi-Upload** (AC: 1)
  - [ ] Track successful upload count
  - [ ] Show prompt when 2+ uploads succeed

- [ ] **Task 2: Create Prompt UI** (AC: 2, 3)
  - [ ] Show prompt modal/section after uploads
  - [ ] Include album name input
  - [ ] Show preview of uploaded images

- [ ] **Task 3: Implement Album Creation** (AC: 4, 6)
  - [ ] Call create album endpoint
  - [ ] Add all uploaded inspirations to album
  - [ ] Set first image as cover
  - [ ] Navigate to new album

- [ ] **Task 4: Handle Skip** (AC: 5)
  - [ ] "Add individually" closes modal
  - [ ] Inspirations remain at root gallery level
  - [ ] Refresh gallery view

## Dev Notes

### PRD Reference
From PRD Create section:
> "Bulk Upload: Upload N images â†’ prompt to create album or add individually"

### Prompt UI

```tsx
function CreateAlbumPrompt({
  uploadedInspirations,
  onCreateAlbum,
  onSkip,
}) {
  const [albumName, setAlbumName] = useState('')

  return (
    <div className="space-y-4">
      <div className="text-center">
        <CheckCircle className="w-12 h-12 text-green-500 mx-auto mb-2" />
        <h3 className="font-medium">
          {uploadedInspirations.length} images uploaded!
        </h3>
        <p className="text-muted-foreground">
          Would you like to organize them in an album?
        </p>
      </div>

      {/* Preview thumbnails */}
      <div className="flex gap-1 justify-center">
        {uploadedInspirations.slice(0, 5).map((insp) => (
          <img
            key={insp.id}
            src={insp.imageUrl}
            alt=""
            className="w-10 h-10 object-cover rounded"
          />
        ))}
        {uploadedInspirations.length > 5 && (
          <div className="w-10 h-10 bg-muted rounded flex items-center justify-center text-xs">
            +{uploadedInspirations.length - 5}
          </div>
        )}
      </div>

      <Input
        placeholder="Album name"
        value={albumName}
        onChange={(e) => setAlbumName(e.target.value)}
      />

      <div className="flex gap-2">
        <Button variant="outline" className="flex-1" onClick={onSkip}>
          Add individually
        </Button>
        <Button
          className="flex-1"
          onClick={() => onCreateAlbum(albumName)}
          disabled={!albumName.trim()}
        >
          Create Album
        </Button>
      </div>
    </div>
  )
}
```

### Album Creation Flow

```typescript
async function handleCreateAlbum(name: string) {
  // 1. Create album
  const album = await createAlbum({ title: name }).unwrap()

  // 2. Add all inspirations to album
  await Promise.all(
    uploadedInspirations.map((insp) =>
      addToAlbum({ albumId: album.id, inspirationId: insp.id }).unwrap()
    )
  )

  // 3. Set first image as cover
  await updateAlbum({
    id: album.id,
    coverImageId: uploadedInspirations[0].id,
  }).unwrap()

  // 4. Navigate to album
  navigate({ to: '/inspiration/albums/$id', params: { id: album.id } })
}
```

### Dependencies
- insp-1030: Multi-Image Upload Modal
- insp-1014: Create Album Endpoint
- insp-1024: Add Inspiration to Album Endpoint

## Testing

- [ ] Prompt shows after 2+ uploads
- [ ] Prompt doesn't show for single upload
- [ ] Album name input works
- [ ] Create album adds all images
- [ ] First image set as cover
- [ ] Skip adds images individually
- [ ] Navigation works after both options

## Change Log

| Date       | Version | Description   | Author   |
| ---------- | ------- | ------------- | -------- |
| 2025-12-27 | 0.1     | Initial draft | SM Agent |
