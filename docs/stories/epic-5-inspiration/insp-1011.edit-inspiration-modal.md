# Story insp-1011: Edit Inspiration Modal

## Status

Draft

## Story

**As a** user,
**I want** to edit an inspiration's metadata via a modal,
**so that** I can update titles, descriptions, tags, and source URLs.

## Acceptance Criteria

1. Edit button in detail view opens edit modal
2. Modal pre-fills with current values
3. Form validates input (title max 200, description max 2000, etc.)
4. Save button calls update endpoint
5. Cancel button closes without saving
6. Updates reflected in detail view after save
7. Shows loading state during save

## Tasks / Subtasks

- [ ] **Task 1: Add Edit Button** (AC: 1)
  - [ ] Add "Edit" button to detail view metadata panel
  - [ ] Button opens edit modal
  - [ ] Use Pencil icon

- [ ] **Task 2: Create Edit Modal** (AC: 2, 3)
  - [ ] Create EditInspirationModal component
  - [ ] Pre-fill form with current values
  - [ ] Add form validation with react-hook-form + Zod

- [ ] **Task 3: Create Form Fields**
  - [ ] Title input (optional, max 200)
  - [ ] Description textarea (optional, max 2000)
  - [ ] Source URL input (optional, valid URL)
  - [ ] Tags input (max 10 tags, max 50 chars each)

- [ ] **Task 4: Implement Save** (AC: 4, 6, 7)
  - [ ] Call update mutation on submit
  - [ ] Show loading state on button
  - [ ] Invalidate query cache on success
  - [ ] Close modal on success

- [ ] **Task 5: Handle Cancel** (AC: 5)
  - [ ] Close modal on cancel
  - [ ] Confirm if form has unsaved changes

## Dev Notes

### Component Location
`apps/web/main-app/src/routes/inspiration/-components/EditInspirationModal/index.tsx`

### Form Setup

```tsx
const EditInspirationSchema = z.object({
  title: z.string().max(200).optional().or(z.literal('')),
  description: z.string().max(2000).optional().or(z.literal('')),
  sourceUrl: z.string().url().optional().or(z.literal('')),
  tags: z.array(z.string().max(50)).max(10),
})

function EditInspirationModal({ inspiration, onClose }) {
  const form = useForm({
    resolver: zodResolver(EditInspirationSchema),
    defaultValues: {
      title: inspiration.title ?? '',
      description: inspiration.description ?? '',
      sourceUrl: inspiration.sourceUrl ?? '',
      tags: inspiration.tags,
    },
  })

  const [updateInspiration, { isLoading }] = useUpdateInspirationMutation()

  async function onSubmit(data) {
    await updateInspiration({ id: inspiration.id, ...data }).unwrap()
    onClose()
  }

  return (
    <Dialog open onOpenChange={onClose}>
      <DialogContent>
        <DialogHeader>
          <DialogTitle>Edit Inspiration</DialogTitle>
        </DialogHeader>
        <Form {...form}>
          <form onSubmit={form.handleSubmit(onSubmit)}>
            {/* Form fields */}
          </form>
        </Form>
      </DialogContent>
    </Dialog>
  )
}
```

### Tag Input
Consider using a tag input component that allows adding/removing tags with chips UI.

### Dependencies
- insp-1010: Update Inspiration Endpoint

## Testing

- [ ] Edit button opens modal
- [ ] Form pre-fills with current values
- [ ] Validation shows errors
- [ ] Save updates inspiration
- [ ] Cancel closes without saving
- [ ] Detail view updates after save

## Change Log

| Date       | Version | Description   | Author   |
| ---------- | ------- | ------------- | -------- |
| 2025-12-27 | 0.1     | Initial draft | SM Agent |
