# Story insp-1013: Delete Inspiration UI

## Status

Draft

## Story

**As a** user,
**I want** a confirmation dialog when deleting an inspiration,
**so that** I don't accidentally delete images permanently.

## Acceptance Criteria

1. Delete button in detail view opens confirmation modal
2. Modal warns deletion is permanent
3. Modal shows how many albums will lose this image
4. Confirm button triggers delete
5. Cancel button closes modal
6. Redirects to gallery after successful delete
7. Shows error toast if delete fails

## Tasks / Subtasks

- [ ] **Task 1: Add Delete Button** (AC: 1)
  - [ ] Add "Delete" button to detail view
  - [ ] Use destructive button variant (red)
  - [ ] Use Trash icon

- [ ] **Task 2: Create Confirmation Modal** (AC: 2, 3)
  - [ ] Create DeleteInspirationModal component
  - [ ] Show permanent deletion warning
  - [ ] Display album count if in albums
  - [ ] List album names for context

- [ ] **Task 3: Implement Delete Action** (AC: 4, 6)
  - [ ] Call delete mutation on confirm
  - [ ] Show loading state on button
  - [ ] Navigate to gallery on success
  - [ ] Invalidate gallery cache

- [ ] **Task 4: Handle Cancel and Errors** (AC: 5, 7)
  - [ ] Close modal on cancel
  - [ ] Show error toast on failure
  - [ ] Keep modal open on error

## Dev Notes

### Component Location
`apps/web/main-app/src/routes/inspiration/-components/DeleteInspirationModal/index.tsx`

### Modal Design (from PRD)

```
┌─────────────────────────────────────────────────────┐
│  Delete this image?                                 │
│                                                     │
│  This image is in 3 albums:                         │
│  • Castle Ideas                                     │
│  • Medieval Builds                                  │
│  • Favorites                                        │
│                                                     │
│  Deleting will remove it from all albums.           │
│  This cannot be undone.                             │
│                                                     │
│              [Cancel]  [Delete permanently]         │
└─────────────────────────────────────────────────────┘
```

### Implementation

```tsx
function DeleteInspirationModal({ inspiration, onClose }) {
  const navigate = useNavigate()
  const [deleteInspiration, { isLoading }] = useDeleteInspirationMutation()

  async function handleDelete() {
    try {
      await deleteInspiration(inspiration.id).unwrap()
      navigate({ to: '/inspiration' })
      toast.success('Image deleted')
    } catch {
      toast.error('Failed to delete. Please try again.')
    }
  }

  return (
    <AlertDialog open onOpenChange={onClose}>
      <AlertDialogContent>
        <AlertDialogHeader>
          <AlertDialogTitle>Delete this image?</AlertDialogTitle>
          <AlertDialogDescription>
            {inspiration.albums.length > 0 && (
              <>
                <p>This image is in {inspiration.albums.length} albums:</p>
                <ul className="list-disc pl-4 my-2">
                  {inspiration.albums.map(a => <li key={a.id}>{a.title}</li>)}
                </ul>
                <p>Deleting will remove it from all albums.</p>
              </>
            )}
            <p className="font-medium text-destructive">
              This cannot be undone.
            </p>
          </AlertDialogDescription>
        </AlertDialogHeader>
        <AlertDialogFooter>
          <AlertDialogCancel>Cancel</AlertDialogCancel>
          <AlertDialogAction
            onClick={handleDelete}
            disabled={isLoading}
            className="bg-destructive hover:bg-destructive/90"
          >
            {isLoading ? 'Deleting...' : 'Delete permanently'}
          </AlertDialogAction>
        </AlertDialogFooter>
      </AlertDialogContent>
    </AlertDialog>
  )
}
```

### Dependencies
- insp-1012: Delete Inspiration Endpoint

## Testing

- [ ] Delete button opens modal
- [ ] Modal shows album list if applicable
- [ ] Modal warns about permanence
- [ ] Confirm deletes and redirects
- [ ] Cancel closes modal
- [ ] Error shows toast

## Change Log

| Date       | Version | Description   | Author   |
| ---------- | ------- | ------------- | -------- |
| 2025-12-27 | 0.1     | Initial draft | SM Agent |
