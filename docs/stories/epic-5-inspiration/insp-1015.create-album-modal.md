# Story insp-1015: Create Album Modal

## Status

Draft

## Story

**As a** user,
**I want** to create a new album via a modal,
**so that** I can easily organize my inspirations.

## Acceptance Criteria

1. "New Album" option in gallery dropdown opens modal
2. Modal has title field (required)
3. Modal has optional description field
4. Modal has optional tags field
5. Create button calls create endpoint
6. Cancel button closes without creating
7. Navigates to new album after creation

## Tasks / Subtasks

- [ ] **Task 1: Add New Album Action** (AC: 1)
  - [ ] Add dropdown menu to gallery header
  - [ ] Include "New Album" option
  - [ ] Opens CreateAlbumModal

- [ ] **Task 2: Create Modal Component** (AC: 2, 3, 4)
  - [ ] Create CreateAlbumModal component
  - [ ] Add title input (required)
  - [ ] Add description textarea (optional)
  - [ ] Add tags input (optional)

- [ ] **Task 3: Implement Create Action** (AC: 5, 7)
  - [ ] Call create album mutation on submit
  - [ ] Show loading state
  - [ ] Navigate to new album on success
  - [ ] Show success toast

- [ ] **Task 4: Handle Cancel** (AC: 6)
  - [ ] Close modal on cancel
  - [ ] Clear form state

## Dev Notes

### Component Location
`apps/web/main-app/src/routes/inspiration/-components/CreateAlbumModal/index.tsx`

### Form Setup

```tsx
const CreateAlbumSchema = z.object({
  title: z.string().min(1, 'Title is required').max(200),
  description: z.string().max(2000).optional(),
  tags: z.array(z.string().max(50)).max(10).default([]),
})

function CreateAlbumModal({ onClose }) {
  const navigate = useNavigate()
  const form = useForm({
    resolver: zodResolver(CreateAlbumSchema),
    defaultValues: { title: '', description: '', tags: [] },
  })

  const [createAlbum, { isLoading }] = useCreateAlbumMutation()

  async function onSubmit(data) {
    const album = await createAlbum(data).unwrap()
    navigate({ to: '/inspiration/albums/$id', params: { id: album.id } })
    toast.success('Album created!')
    onClose()
  }

  return (
    <Dialog open onOpenChange={onClose}>
      <DialogContent>
        <DialogHeader>
          <DialogTitle>Create Album</DialogTitle>
        </DialogHeader>
        <Form {...form}>
          <form onSubmit={form.handleSubmit(onSubmit)} className="space-y-4">
            <FormField
              name="title"
              control={form.control}
              render={({ field }) => (
                <FormItem>
                  <FormLabel>Title *</FormLabel>
                  <FormControl>
                    <Input {...field} placeholder="Album name" />
                  </FormControl>
                  <FormMessage />
                </FormItem>
              )}
            />
            <FormField
              name="description"
              control={form.control}
              render={({ field }) => (
                <FormItem>
                  <FormLabel>Description</FormLabel>
                  <FormControl>
                    <Textarea {...field} placeholder="Optional description" />
                  </FormControl>
                </FormItem>
              )}
            />
            {/* Tags input */}
            <DialogFooter>
              <Button variant="outline" onClick={onClose}>Cancel</Button>
              <Button type="submit" disabled={isLoading}>
                {isLoading ? 'Creating...' : 'Create Album'}
              </Button>
            </DialogFooter>
          </form>
        </Form>
      </DialogContent>
    </Dialog>
  )
}
```

### Dependencies
- insp-1014: Create Album Endpoint

## Testing

- [ ] Modal opens from dropdown
- [ ] Title is required
- [ ] Validation shows errors
- [ ] Create works and navigates
- [ ] Cancel closes modal
- [ ] Success toast appears

## Change Log

| Date       | Version | Description   | Author   |
| ---------- | ------- | ------------- | -------- |
| 2025-12-27 | 0.1     | Initial draft | SM Agent |
