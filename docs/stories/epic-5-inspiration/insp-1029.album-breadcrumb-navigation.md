# Story insp-1029: Album Breadcrumb Navigation

## Status

Draft

## Story

**As a** user,
**I want** to see breadcrumb navigation when browsing albums,
**so that** I can understand where I am and navigate back.

## Acceptance Criteria

1. Breadcrumb shows path taken to current album (session-based)
2. Not canonical path (since albums can have multiple parents)
3. Each breadcrumb segment is clickable
4. "Gallery" as root link
5. Back button returns to immediate previous location
6. Handles deep nesting gracefully

## Tasks / Subtasks

- [ ] **Task 1: Track Navigation Path** (AC: 1, 2)
  - [ ] Store navigation path in session/route state
  - [ ] Update path when navigating into albums
  - [ ] Push new segment on album enter
  - [ ] Pop segment on back navigation

- [ ] **Task 2: Create Breadcrumb Component** (AC: 3, 4)
  - [ ] Create AlbumBreadcrumbs component
  - [ ] Show "Gallery" as root
  - [ ] Show path segments as links
  - [ ] Style with separators

- [ ] **Task 3: Handle Navigation** (AC: 3, 5)
  - [ ] Click segment navigates to that album
  - [ ] Truncate path to clicked segment
  - [ ] Back button uses router history

- [ ] **Task 4: Handle Deep Nesting** (AC: 6)
  - [ ] Truncate middle segments if too long
  - [ ] Show "..." for hidden segments
  - [ ] Ensure current album always visible

## Dev Notes

### Session-Based Path (from PRD)
Per PRD: "Breadcrumb trail shows **path taken** (session-based), not canonical path"

This is important because albums can have multiple parents. The breadcrumb shows how the user got here, not the "official" path.

### Navigation State Management

Option 1: Route State
```tsx
// When navigating into album
navigate({
  to: '/inspiration/albums/$id',
  params: { id: album.id },
  state: {
    breadcrumbs: [...currentBreadcrumbs, { id: album.id, title: album.title }]
  }
})
```

Option 2: Context/Store
```tsx
// Navigation context
const { breadcrumbs, pushBreadcrumb, popTo } = useNavigationContext()

function navigateToAlbum(album: Album) {
  pushBreadcrumb({ id: album.id, title: album.title })
  navigate({ to: '/inspiration/albums/$id', params: { id: album.id } })
}
```

### Breadcrumb Component

```tsx
interface Breadcrumb {
  id: string | null  // null for root gallery
  title: string
}

function AlbumBreadcrumbs({ breadcrumbs }: { breadcrumbs: Breadcrumb[] }) {
  const navigate = useNavigate()

  // Truncate if too many
  const displayCrumbs = breadcrumbs.length > 4
    ? [
        breadcrumbs[0],
        { id: 'ellipsis', title: '...' },
        ...breadcrumbs.slice(-2)
      ]
    : breadcrumbs

  return (
    <nav className="flex items-center space-x-2 text-sm">
      <button
        onClick={() => navigate({ to: '/inspiration' })}
        className="text-muted-foreground hover:text-foreground"
      >
        Gallery
      </button>

      {displayCrumbs.map((crumb, i) => (
        <Fragment key={crumb.id ?? 'root'}>
          <ChevronRight className="w-4 h-4 text-muted-foreground" />
          {crumb.id === 'ellipsis' ? (
            <span className="text-muted-foreground">...</span>
          ) : (
            <button
              onClick={() => handleNavigate(crumb, i)}
              className={cn(
                i === displayCrumbs.length - 1
                  ? "font-medium"
                  : "text-muted-foreground hover:text-foreground"
              )}
            >
              {crumb.title}
            </button>
          )}
        </Fragment>
      ))}
    </nav>
  )
}
```

### Dependencies
- insp-1019: Album View Page (integrate breadcrumbs)

## Testing

- [ ] Breadcrumb shows navigation path
- [ ] Root shows "Gallery"
- [ ] Clicking segment navigates correctly
- [ ] Path updates on album navigation
- [ ] Back button works correctly
- [ ] Deep nesting truncates with "..."
- [ ] Path is session-based, not canonical

## Change Log

| Date       | Version | Description   | Author   |
| ---------- | ------- | ------------- | -------- |
| 2025-12-27 | 0.1     | Initial draft | SM Agent |
