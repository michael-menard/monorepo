# Story insp-1001: Zod Schemas & Shared Types

## Status

Draft

## Story

**As a** developer,
**I want** Zod schemas and shared types for Inspiration and Album entities,
**so that** we have type-safe validation across frontend and backend.

## Acceptance Criteria

1. InspirationSchema with all entity fields defined
2. AlbumSchema with all entity fields defined
3. API request schemas (CreateInspirationRequest, UpdateInspirationRequest, etc.)
4. API response schemas (InspirationResponse, InspirationListResponse, etc.)
5. Schemas exported from shared package accessible to both FE and BE
6. All schemas include appropriate validation constraints (uuid, url, array limits, etc.)

## Tasks / Subtasks

- [ ] **Task 1: Create Inspiration Schemas** (AC: 1, 6)
  - [ ] Create InspirationSchema with all fields
  - [ ] Add validation constraints (uuid for id, url for imageUrl/sourceUrl, max 10 tags)
  - [ ] Create InspirationSummarySchema for list views

- [ ] **Task 2: Create Album Schemas** (AC: 2, 6)
  - [ ] Create AlbumSchema with all fields
  - [ ] Add validation constraints
  - [ ] Create AlbumSummarySchema for list views
  - [ ] Create AlbumWithContentsSchema for detail views

- [ ] **Task 3: Create API Request Schemas** (AC: 3)
  - [ ] CreateInspirationRequestSchema
  - [ ] UpdateInspirationRequestSchema
  - [ ] CreateAlbumRequestSchema
  - [ ] UpdateAlbumRequestSchema
  - [ ] ListQuerySchema (pagination, sorting, filtering)

- [ ] **Task 4: Create API Response Schemas** (AC: 4)
  - [ ] InspirationResponseSchema
  - [ ] InspirationListResponseSchema (with pagination)
  - [ ] AlbumResponseSchema
  - [ ] AlbumListResponseSchema
  - [ ] AlbumContentsResponseSchema

- [ ] **Task 5: Export from Shared Package** (AC: 5)
  - [ ] Add schemas to appropriate shared package
  - [ ] Export types using z.infer<>
  - [ ] Verify imports work from both FE and BE

## Dev Notes

### Package Location
Consider placing in one of:
- `packages/core/api-client/src/schemas/` (if API-specific)
- `packages/core/types/` (if new shared types package needed)
- Follow existing pattern from MOC Instructions schemas

### Schema Patterns

```typescript
import { z } from 'zod'

// Base entity schema
export const InspirationSchema = z.object({
  id: z.string().uuid(),
  userId: z.string().uuid(),
  imageUrl: z.string().url(),
  title: z.string().max(200).nullable(),
  description: z.string().max(2000).nullable(),
  sourceUrl: z.string().url().nullable(),
  tags: z.array(z.string().max(50)).max(10).default([]),
  albumIds: z.array(z.string().uuid()).default([]),
  mocIds: z.array(z.string().uuid()).default([]),
  sortOrder: z.number().int().nonnegative(),
  createdAt: z.string().datetime(),
  updatedAt: z.string().datetime(),
})

export type Inspiration = z.infer<typeof InspirationSchema>

// Request schemas (partial, for create/update)
export const CreateInspirationRequestSchema = InspirationSchema.pick({
  imageUrl: true,
  title: true,
  description: true,
  sourceUrl: true,
  tags: true,
}).partial({
  title: true,
  description: true,
  sourceUrl: true,
  tags: true,
})
```

### Validation Rules from PRD
- Tags: max 10 per item, max 50 chars each
- Title: optional, max 200 chars
- Description: optional, max 2000 chars
- URLs must be valid format

## Testing

- [ ] All schemas validate correct data
- [ ] Schemas reject invalid data with appropriate errors
- [ ] Type inference works correctly
- [ ] Imports resolve from both FE and BE packages

## Change Log

| Date       | Version | Description   | Author   |
| ---------- | ------- | ------------- | -------- |
| 2025-12-27 | 0.1     | Initial draft | SM Agent |
