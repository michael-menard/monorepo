# Story insp-1007: Get Single Inspiration Endpoint

## Status

Draft

## Story

**As a** user,
**I want** to retrieve a single inspiration's full details,
**so that** I can view the full-size image and all metadata.

## Acceptance Criteria

1. GET /api/inspirations/:id returns inspiration details
2. Includes all fields (image, title, description, sourceUrl, tags)
3. Includes list of albumIds this inspiration belongs to
4. Includes list of mocIds this inspiration is linked to
5. Returns 404 if not found
6. Returns 403 if user doesn't own inspiration

## Tasks / Subtasks

- [ ] **Task 1: Create Get Endpoint** (AC: 1, 5, 6)
  - [ ] Create GET /api/inspirations/:id handler
  - [ ] Add authentication middleware
  - [ ] Validate ownership (userId matches)
  - [ ] Return 404 for non-existent
  - [ ] Return 403 for unauthorized access

- [ ] **Task 2: Fetch Complete Data** (AC: 2, 3, 4)
  - [ ] Fetch inspiration record
  - [ ] Join/fetch album memberships
  - [ ] Join/fetch MOC links
  - [ ] Format response with all fields

- [ ] **Task 3: Add to Serverless Config**
  - [ ] Add Lambda function definition
  - [ ] Configure API Gateway route with path param

## Dev Notes

### Endpoint Location
`apps/api/endpoints/inspirations/get/handler.ts`

### Path Parameter
Extract `:id` from path and validate as UUID.

### Response

```typescript
const InspirationDetailResponseSchema = z.object({
  id: z.string().uuid(),
  userId: z.string().uuid(),
  imageUrl: z.string().url(),
  title: z.string().nullable(),
  description: z.string().nullable(),
  sourceUrl: z.string().url().nullable(),
  tags: z.array(z.string()),
  albumIds: z.array(z.string().uuid()),
  mocIds: z.array(z.string().uuid()),
  sortOrder: z.number().int(),
  createdAt: z.string().datetime(),
  updatedAt: z.string().datetime(),
  // Additional album info for "Also in:" display
  albums: z.array(z.object({
    id: z.string().uuid(),
    title: z.string(),
  })),
})
```

### Album Membership Query
Join inspiration_albums table to get album IDs and titles for "Also in:" display in detail view.

## Testing

- [ ] Returns inspiration with all fields
- [ ] Includes album membership info
- [ ] Includes MOC link info
- [ ] Returns 404 for non-existent ID
- [ ] Returns 403 for other user's inspiration
- [ ] Returns 401 for unauthenticated

## Change Log

| Date       | Version | Description   | Author   |
| ---------- | ------- | ------------- | -------- |
| 2025-12-27 | 0.1     | Initial draft | SM Agent |
