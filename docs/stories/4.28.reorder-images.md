# Story 4.28: Reorder Images

## Status

Approved

## Story

**As a** user,
**I want** to reorder my MOC images,
**so that** they display in my preferred order.

## Acceptance Criteria

1. â¬œ Drag and drop to reorder
2. â¬œ Up/down buttons as alternative
3. â¬œ Visual feedback during drag
4. â¬œ Saves new order to API
5. ðŸ”„ Backend: Reorder endpoint required

## Tasks / Subtasks

- [ ] **Task 1: Drag and Drop**
  - [ ] Use dnd-kit or similar
  - [ ] Visual drag indicators

- [ ] **Task 2: Button Controls**
  - [ ] Move up/down buttons
  - [ ] Accessibility

- [ ] **Task 3: Save Order**
  - [ ] API call on change
  - [ ] Optimistic update

## Dev Notes

```typescript
import { DndContext, closestCenter } from '@dnd-kit/core'
import { SortableContext, useSortable, verticalListSortingStrategy } from '@dnd-kit/sortable'

function ImageReorderer({ mocId, images }: ImageReordererProps) {
  const [reorderImages] = useReorderImagesMutation()

  const handleDragEnd = async (event: DragEndEvent) => {
    const { active, over } = event
    if (active.id !== over?.id) {
      const oldIndex = images.findIndex(i => i.id === active.id)
      const newIndex = images.findIndex(i => i.id === over?.id)
      const newOrder = arrayMove(images, oldIndex, newIndex)

      await reorderImages({
        mocId,
        imageIds: newOrder.map(i => i.id),
      })
    }
  }

  return (
    <DndContext collisionDetection={closestCenter} onDragEnd={handleDragEnd}>
      <SortableContext items={images.map(i => i.id)} strategy={verticalListSortingStrategy}>
        {images.map((image) => (
          <SortableImage key={image.id} image={image} />
        ))}
      </SortableContext>
    </DndContext>
  )
}
```

## Change Log

| Date       | Version | Description   | Author   |
| ---------- | ------- | ------------- | -------- |
| 2025-11-28 | 0.1     | Initial draft | SM Agent |
