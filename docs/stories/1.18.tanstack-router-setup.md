# Story 1.18: TanStack Router Setup

## Status

Approved

## Story

**As a** developer,
**I want** TanStack Router configured with type-safe routes,
**so that** navigation is type-safe and performant.

## Acceptance Criteria

1. ⬜ TanStack Router v1.x installed and configured
2. ⬜ Root route with RootLayout component
3. ⬜ Route tree generated/defined
4. ⬜ RouterProvider in App.tsx
5. ⬜ Type-safe Link components work
6. ⬜ Route context provides auth state

## Tasks / Subtasks

- [ ] **Task 1: Verify Package Installation** (AC: 1)
  - [ ] Check @tanstack/react-router in package.json
  - [ ] Verify version is 1.x

- [ ] **Task 2: Router Configuration** (AC: 2-4)
  - [ ] Create/verify router instance
  - [ ] Define root route with RootLayout
  - [ ] Generate or define route tree
  - [ ] Wrap app in RouterProvider

- [ ] **Task 3: Type Safety** (AC: 5)
  - [ ] Verify Link component has type-safe "to" prop
  - [ ] Test autocomplete works for routes

- [ ] **Task 4: Route Context** (AC: 6)
  - [ ] Pass auth state in route context
  - [ ] Guards can access context.auth

## Dev Notes

### Existing Implementation

**File:** `apps/web/main-app/src/routes/index.ts`

### Router Setup

```typescript
import { createRouter, createRootRoute } from '@tanstack/react-router'
import { RootLayout } from '@/components/Layout/RootLayout'

const rootRoute = createRootRoute({
  component: RootLayout,
})

const routeTree = rootRoute.addChildren([
  // Child routes defined here
])

export const router = createRouter({
  routeTree,
  context: {
    auth: undefined!, // Will be provided by AuthProvider
  },
})

// Type registration
declare module '@tanstack/react-router' {
  interface Register {
    router: typeof router
  }
}
```

### App.tsx Integration

```typescript
import { RouterProvider } from '@tanstack/react-router'
import { router } from './routes'

function App() {
  const auth = useAppSelector(selectAuth)

  return (
    <RouterProvider
      router={router}
      context={{ auth }}
    />
  )
}
```

### Route Definition Pattern

```typescript
import { createFileRoute } from '@tanstack/react-router'

export const Route = createFileRoute('/dashboard')({
  component: DashboardPage,
  beforeLoad: RouteGuards.protected,
})
```

### Testing

- Test router initializes without error
- Test navigation works
- Test Link components render
- Test context is accessible in guards

## Change Log

| Date       | Version | Description   | Author   |
| ---------- | ------- | ------------- | -------- |
| 2025-11-28 | 0.1     | Initial draft | SM Agent |
