# Story 4.24: File Type Validation

## Status

Approved

## Story

**As a** user,
**I want** invalid file types rejected,
**so that** I only upload compatible files.

## Acceptance Criteria

1. ⬜ Validate file extension
2. ⬜ Validate MIME type
3. ⬜ Show clear error message
4. ⬜ Prevent upload of invalid files
5. ⬜ List accepted types in UI

## Tasks / Subtasks

- [ ] **Task 1: Validation Function**
  - [ ] Check extension
  - [ ] Check MIME type

- [ ] **Task 2: Error Handling**
  - [ ] Toast with error
  - [ ] Specify accepted types

## Dev Notes

```typescript
const FILE_TYPES = {
  image: {
    extensions: ['.jpg', '.jpeg', '.png', '.webp'],
    mimes: ['image/jpeg', 'image/png', 'image/webp'],
    label: 'Images (JPG, PNG, WebP)',
  },
  pdf: {
    extensions: ['.pdf'],
    mimes: ['application/pdf'],
    label: 'PDF documents',
  },
  parts: {
    extensions: ['.xml', '.csv', '.json'],
    mimes: ['text/xml', 'application/xml', 'text/csv', 'application/json'],
    label: 'Parts lists (XML, CSV, JSON)',
  },
}

function validateFileType(file: File, type: keyof typeof FILE_TYPES): boolean {
  const config = FILE_TYPES[type]
  const ext = '.' + file.name.split('.').pop()?.toLowerCase()

  const validExtension = config.extensions.includes(ext)
  const validMime = config.mimes.includes(file.type)

  if (!validExtension || !validMime) {
    toast.error(`Invalid file type. Accepted: ${config.label}`)
    return false
  }

  return true
}
```

## Change Log

| Date       | Version | Description   | Author   |
| ---------- | ------- | ------------- | -------- |
| 2025-11-28 | 0.1     | Initial draft | SM Agent |
