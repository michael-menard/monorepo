# Story 4.19: Delete MOC

## Status

Approved

## Story

**As a** user,
**I want** to delete a MOC,
**so that** I can remove unwanted items.

## Acceptance Criteria

1. ⬜ Delete button on edit page
2. ⬜ Confirmation modal before delete
3. ⬜ Warning about permanent deletion
4. ⬜ Deletes MOC and all files
5. ⬜ Redirects to gallery after delete

## Tasks / Subtasks

- [ ] **Task 1: Delete Button**
  - [ ] Add button (destructive style)
  - [ ] Opens confirmation modal

- [ ] **Task 2: Confirmation Modal**
  - [ ] Warning message
  - [ ] Cancel and Confirm buttons

- [ ] **Task 3: Delete Action**
  - [ ] Call deleteMoc mutation
  - [ ] Handle success/error

## Dev Notes

```typescript
function DeleteMocButton({ mocId, mocTitle }: DeleteMocButtonProps) {
  const [open, setOpen] = useState(false)
  const [deleteMoc, { isLoading }] = useDeleteMocMutation()
  const navigate = useNavigate()

  const handleDelete = async () => {
    try {
      await deleteMoc(mocId).unwrap()
      toast.success('MOC deleted')
      navigate({ to: '/gallery' })
    } catch {
      toast.error('Failed to delete MOC')
    }
  }

  return (
    <>
      <Button variant="destructive" onClick={() => setOpen(true)}>
        <Trash2 className="mr-2 h-4 w-4" />
        Delete MOC
      </Button>

      <AlertDialog open={open} onOpenChange={setOpen}>
        <AlertDialogContent>
          <AlertDialogHeader>
            <AlertDialogTitle>Delete "{mocTitle}"?</AlertDialogTitle>
            <AlertDialogDescription>
              This will permanently delete this MOC and all its files.
              This action cannot be undone.
            </AlertDialogDescription>
          </AlertDialogHeader>
          <AlertDialogFooter>
            <AlertDialogCancel>Cancel</AlertDialogCancel>
            <AlertDialogAction onClick={handleDelete} disabled={isLoading}>
              {isLoading ? 'Deleting...' : 'Delete'}
            </AlertDialogAction>
          </AlertDialogFooter>
        </AlertDialogContent>
      </AlertDialog>
    </>
  )
}
```

## Change Log

| Date       | Version | Description   | Author   |
| ---------- | ------- | ------------- | -------- |
| 2025-11-28 | 0.1     | Initial draft | SM Agent |
