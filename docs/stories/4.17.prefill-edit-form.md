# Story 4.17: Prefill Edit Form

## Status

Approved

## Story

**As a** user,
**I want** the edit form pre-filled with existing data,
**so that** I can see current values.

## Acceptance Criteria

1. ⬜ Form populated with MOC data
2. ⬜ Title, description, theme, tags filled
3. ⬜ Cover image displayed
4. ⬜ Can modify any field
5. ⬜ Dirty state tracking

## Tasks / Subtasks

- [ ] **Task 1: Default Values**
  - [ ] Pass moc to form
  - [ ] Set defaultValues

- [ ] **Task 2: Cover Image**
  - [ ] Show existing cover
  - [ ] Option to replace

## Dev Notes

```typescript
interface MocFormProps {
  moc?: MocDetail  // If provided, edit mode
  onSuccess: (moc: MocDetail) => void
}

function MocForm({ moc, onSuccess }: MocFormProps) {
  const isEdit = !!moc

  const form = useForm<MocFormValues>({
    resolver: zodResolver(mocFormSchema),
    defaultValues: moc ? {
      title: moc.title,
      description: moc.description || '',
      theme: moc.theme,
      tags: moc.tags,
    } : {
      title: '',
      description: '',
      theme: '',
      tags: [],
    },
  })

  const [existingCover, setExistingCover] = useState(
    moc?.images.find(i => i.isCover)?.url || null
  )

  // Track if form has changes
  const isDirty = form.formState.isDirty || coverChanged

  return (
    <Form {...form}>
      {/* If has existing cover and not replacing */}
      {existingCover && !coverImage && (
        <CurrentCoverImage url={existingCover} onReplace={() => setExistingCover(null)} />
      )}
      {/* ... form fields */}
    </Form>
  )
}
```

## Change Log

| Date       | Version | Description   | Author   |
| ---------- | ------- | ------------- | -------- |
| 2025-11-28 | 0.1     | Initial draft | SM Agent |
