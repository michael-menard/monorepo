# Story 5.23: Wishlist Unit Tests

## Status

Approved

## Story

**As a** developer,
**I want** unit tests for wishlist components,
**so that** functionality is verified.

## Acceptance Criteria

1. ⬜ Tests for WishlistItemCard
2. ⬜ Tests for form validation
3. ⬜ Tests for add/edit/delete flows
4. ⬜ Tests for view toggle
5. ⬜ Minimum 45% code coverage

## Tasks / Subtasks

- [ ] **Task 1: Component Tests**
  - [ ] Test card renders data
  - [ ] Test form validation
  - [ ] Test modal open/close

- [ ] **Task 2: Integration Tests**
  - [ ] Test add item flow
  - [ ] Test delete with confirmation

- [ ] **Task 3: Coverage**
  - [ ] Run coverage report
  - [ ] Verify 45% minimum

## Dev Notes

```typescript
describe('WishlistItemCard', () => {
  it('displays item information', () => {
    render(<WishlistItemCard item={mockItem} onEdit={vi.fn()} onDelete={vi.fn()} />)
    expect(screen.getByText(mockItem.name)).toBeInTheDocument()
    expect(screen.getByText('MOC')).toBeInTheDocument()
  })

  it('opens external link in new tab', () => {
    render(<WishlistItemCard item={mockItem} onEdit={vi.fn()} onDelete={vi.fn()} />)
    const link = screen.getByRole('link', { name: /visit/i })
    expect(link).toHaveAttribute('target', '_blank')
    expect(link).toHaveAttribute('rel', 'noopener noreferrer')
  })
})

describe('WishlistItemForm', () => {
  it('validates URL format', async () => {
    render(<WishlistItemForm onSuccess={vi.fn()} onCancel={vi.fn()} />)

    await userEvent.type(screen.getByLabelText(/url/i), 'not-a-url')
    await userEvent.click(screen.getByRole('button', { name: /save/i }))

    expect(screen.getByText(/valid url/i)).toBeInTheDocument()
  })
})
```

## Change Log

| Date       | Version | Description   | Author   |
| ---------- | ------- | ------------- | -------- |
| 2025-11-28 | 0.1     | Initial draft | SM Agent |
