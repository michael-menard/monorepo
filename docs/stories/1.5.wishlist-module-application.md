# Story 1.5: Wishlist Module Application

## Status

Draft

## Story

**As a** user,
**I want** an enhanced wishlist module with improved list management,
**so that** I can organize and manage my LEGO wishlist items more effectively.

## Acceptance Criteria

1. Wishlist app extracted to `apps/web/wishlist-app/` using existing `@repo/features-wishlist` package
2. Enhanced UI with drag-and-drop functionality and better list organization
3. Integration with serverless API endpoints for wishlist operations
4. Improved sharing and export functionality
5. Real-time updates and optimistic UI patterns
6. Mobile-optimized interface for wishlist management

## Integration Verification

- **IV1**: Existing wishlist data and functionality remain fully accessible
- **IV2**: Wishlist operations (add, remove, update) continue working seamlessly
- **IV3**: User wishlist data integrity is maintained throughout migration

## Dev Notes

### Technical Context

This story extracts the existing comprehensive wishlist functionality from the monolithic app into a standalone modular application, leveraging the existing `@repo/features-wishlist` package while enhancing it with modern UI components and serverless integration.

### Architecture References

- **Component Architecture**: Wishlist Module Application with enhanced list management and sharing features [Source: architecture/component-architecture.md#wishlist-module-application]
- **User Flows**: Gallery to Wishlist flow integration for seamless item addition [Source: front-end-spec/user-flows.md#flow-1-discover-and-save-moc-to-wishlist]
- **Technology Stack**: React 19, drag-and-drop libraries, enhanced UI components [Source: architecture/tech-stack.md]

### Existing Wishlist Package Analysis

**Current Wishlist Package** (`@repo/features-wishlist` - `packages/features/wishlist/`):

**Comprehensive Feature Set**:

- ✅ **Wishlist Management**: Create and manage wishlists for LEGO sets and parts
- ✅ **Multi-Select**: Advanced multi-select functionality with bulk operations
- ✅ **Batch Operations**: Delete, toggle purchased, update priority/category in bulk
- ✅ **Drag & Drop**: Reorder wishlist items with keyboard accessibility
- ✅ **Categorization**: Organize items by categories, tags, and priority levels
- ✅ **RTK Query Integration**: Complete API layer with caching and optimistic updates
- ✅ **Responsive Design**: Mobile-first layout with Tailwind CSS
- ✅ **Accessibility**: Keyboard navigation and screen reader support

**Existing Components**:

- `Wishlist`: Main component with filtering and multi-select
- `WishlistItemCard`: Individual item display with actions
- `BatchOperationsToolbar`: Bulk operations interface
- `AddEditWishlistModal`: Item creation and editing
- `CategoryFilter`: Category and priority filtering

**Current API Hooks**:

- `useGetWishlistsQuery`, `useGetWishlistItemsQuery`
- `useCreateWishlistMutation`, `useUpdateWishlistMutation`
- `useBatchDeleteWishlistItemsMutation`, `useBatchTogglePurchasedMutation`
- `useReorderWishlistItemsMutation` for drag-and-drop

**Current Technology Stack**:

- React 19, Framer Motion, RTK Query, Tailwind CSS v4
- TypeScript with Zod schemas, comprehensive accessibility support
- Already uses `@repo/ui` components and `@repo/accessibility`

### Wishlist Module Enhancement Strategy

**Leverage Existing Strengths**:

- ✅ **Rich Feature Set**: Comprehensive wishlist management already implemented
- ✅ **Advanced Interactions**: Multi-select, batch operations, drag-and-drop
- ✅ **Accessibility**: Full keyboard navigation and screen reader support
- ✅ **Performance**: RTK Query with caching and optimistic updates

**Enhancement Areas**:

1. **UI Components**: Upgrade to enhanced shadcn/ui components from Story 1.1
2. **API Integration**: Connect to serverless endpoints from Story 1.2
3. **Module Structure**: Extract into standalone app with shell integration
4. **Sharing Features**: Enhanced sharing and export functionality
5. **Real-time Updates**: WebSocket integration for collaborative features

### Key Interfaces

- Wishlist creation, organization, and management
- Drag-and-drop functionality for list organization
- Sharing and collaboration features
- Integration with gallery for item addition (cross-module communication)

### File Locations

- **Wishlist App**: `apps/web/wishlist-app/` (new standalone application)
- **Wishlist Components**: `apps/web/wishlist-app/src/components/` (app-specific components)
- **Wishlist Pages**: `apps/web/wishlist-app/src/pages/` (wishlist routing and pages)
- **Wishlist Services**: `apps/web/wishlist-app/src/services/` (wishlist-specific API integration)
- **Wishlist Store**: `apps/web/wishlist-app/src/store/` (wishlist state management)
- **Existing Package**: `packages/features/wishlist/` (enhanced with new components)

### Enhanced User Experience Features

**Modern List Management** (using enhanced shadcn/ui components):

- Enhanced Card component variants for wishlist items
- Improved drag-and-drop with visual feedback
- Better touch targets and mobile interactions
- Enhanced loading states and skeleton screens

**Advanced Organization**:

- Category and priority management with improved UX
- Smart filtering and search with serverless performance
- Bulk operations with better confirmation dialogs
- Export functionality (CSV, PDF, sharing links)

**Real-time Collaboration**:

- Optimistic UI updates for immediate feedback
- Real-time updates for shared wishlists
- Collaborative editing with conflict resolution
- Activity feed for shared wishlist changes

### Testing Requirements

- Unit tests for wishlist components using existing Vitest setup
- Integration tests for serverless API endpoints and batch operations
- Accessibility testing for drag-and-drop and keyboard navigation
- Performance testing for large wishlist management
- Cross-module integration testing (gallery → wishlist communication)

### Technical Constraints

- Must maintain existing `@repo/features-wishlist` package functionality
- Existing wishlist API hooks and data structures must continue working
- Current wishlist data and user interactions must remain functional
- Drag-and-drop and accessibility features must be preserved
- Must integrate with shell app routing from Story 1.3

## Tasks / Subtasks

- [ ] **Task 1: Create wishlist app structure** (AC: 1)
  - [ ] Create `apps/web/wishlist-app/` directory with package.json
  - [ ] Set up Vite configuration for wishlist app
  - [ ] Configure TypeScript, ESLint, and testing setup
  - [ ] Create basic app entry point and routing structure

- [ ] **Task 2: Enhance `packages/features/wishlist/` package** (AC: 2, 6)
  - [ ] **Update existing components**: Upgrade Wishlist, WishlistItemCard, BatchOperationsToolbar with shadcn/ui
  - [ ] **Improve mobile interactions**: Enhance existing WishlistItemCard with better touch targets and gestures
  - [ ] **Enhance drag-and-drop**: Improve existing drag-and-drop with better visual feedback and animations
  - [ ] **Optimize batch operations**: Update existing BatchOperationsToolbar for mobile usage patterns

- [ ] **Task 3: Integrate serverless API endpoints** (AC: 3, 5)
  - [ ] Connect existing RTK Query hooks to serverless endpoints from Story 1.2
  - [ ] Implement enhanced wishlist API integration with performance monitoring
  - [ ] Add optimistic UI updates for better perceived performance
  - [ ] Update error handling for serverless response patterns

- [ ] **Task 4: Implement enhanced sharing and export** (AC: 4)
  - [ ] Create sharing functionality with public/private wishlist options
  - [ ] Add export capabilities (CSV, PDF, sharing links)
  - [ ] Implement collaborative wishlist features
  - [ ] Add social sharing integration for wishlist items

- [ ] **Task 5: Create wishlist app pages and routing** (AC: 1, 6)
  - [ ] Create main wishlist management page
  - [ ] Implement wishlist creation and editing pages
  - [ ] Add shared wishlist viewing page
  - [ ] Set up responsive routing for mobile and desktop

- [ ] **Task 6: Optimize mobile interface** (AC: 6)
  - [ ] Enhance touch interactions for drag-and-drop
  - [ ] Optimize batch operations for mobile usage
  - [ ] Improve mobile navigation and filtering
  - [ ] Add swipe gestures for common actions

- [ ] **Task 7: Implement real-time updates** (AC: 5)
  - [ ] Add optimistic UI updates for all wishlist operations
  - [ ] Implement real-time synchronization for shared wishlists
  - [ ] Add conflict resolution for concurrent edits
  - [ ] Create activity feed for collaborative features

- [ ] **Task 8: Enhance cross-module integration** (AC: 2)
  - [ ] Set up communication with gallery module for "Add to Wishlist" functionality
  - [ ] Implement shared state management for cross-module actions
  - [ ] Add deep linking from gallery to specific wishlist categories
  - [ ] Test gallery → wishlist user flow integration

- [ ] **Task 9: Integration testing and validation** (IV1, IV2, IV3)
  - [ ] Test existing wishlist data and functionality remain fully accessible
  - [ ] Validate all wishlist operations continue working seamlessly
  - [ ] Verify user wishlist data integrity throughout migration
  - [ ] Test cross-module communication and real-time updates

## Testing

- Unit tests using Vitest for wishlist components and enhanced UI
- Integration tests for serverless API endpoints and batch operations
- Accessibility testing with axe-core for drag-and-drop and keyboard navigation
- Performance testing for large wishlist management and real-time updates
- Mobile testing for touch interactions and responsive design
- Cross-module integration testing for gallery → wishlist communication

## Dependencies

- **Depends on**: Story 1.1 (Enhanced Shared Component Library) - for enhanced UI components
- **Depends on**: Story 1.2 (Serverless API Client Foundation) - for API integration
- **Depends on**: Story 1.3 (Shell Application Foundation) - for app routing and integration
- **Integrates with**: Story 1.4 (Gallery Module) - for cross-module wishlist functionality

## Change Log

| Date       | Author        | Change                                                                     |
| ---------- | ------------- | -------------------------------------------------------------------------- |
| 2024-11-24 | Story Manager | Initial story creation leveraging existing @repo/features-wishlist package |
