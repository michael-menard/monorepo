# Story 1.13.11: Signup Page

## Status

Complete

## Story

**As a** new user,
**I want** a signup page with name, email, and password fields,
**so that** I can create an account and join the LEGO MOC Hub community.

## Acceptance Criteria

1. ✅ Signup page exists at /register route
2. ✅ Full name input with validation (min 2 characters)
3. ✅ Email input with validation
4. ✅ Password input with show/hide toggle
5. ✅ Password strength indicator
6. ✅ Confirm password input with match validation
7. ✅ Terms and conditions checkbox (required)
8. ✅ Submit button calls Amplify signUp
9. ✅ Success message displayed after signup
10. ✅ Redirect to email verification page with email
11. ✅ Error handling for existing accounts and other errors
12. ✅ Loading state during registration
13. ✅ Link to login page
14. ✅ Link back to home page
15. ✅ Accessible form with ARIA labels
16. ✅ Unit tests exist (43 tests)

## Tasks / Subtasks

- [x] **Task 1: Page Setup** (AC: 1, 13, 14)
  - [x] Create SignupPage component
  - [x] Route at /register with guestOnly guard
  - [x] Use AuthLayout wrapper
  - [x] "Sign in here" link to /login
  - [x] "Back to Home" button

- [x] **Task 2: Form Fields** (AC: 2-6)
  - [x] Full name input with User icon
  - [x] Email input with Mail icon
  - [x] Password input with Lock icon and show/hide toggle
  - [x] Password strength indicator (4 segments)
  - [x] Confirm password input with show/hide toggle
  - [x] Zod validation schema with password match refinement

- [x] **Task 3: Terms Acceptance** (AC: 7)
  - [x] Checkbox for terms acceptance
  - [x] Link to Terms of Service page
  - [x] Link to Privacy Policy page
  - [x] Validation requiring acceptance

- [x] **Task 4: Amplify Integration** (AC: 8, 10)
  - [x] Call signUp from AuthProvider
  - [x] Pass name, email, password to Amplify
  - [x] Handle requiresConfirmation response
  - [x] Navigate to /verify-email with email parameter

- [x] **Task 5: Success/Error Handling** (AC: 9, 11, 12)
  - [x] Display success alert with green styling
  - [x] Display error alert with destructive styling
  - [x] Loading spinner during submission
  - [x] Disabled state for form during loading

- [x] **Task 6: Accessibility** (AC: 15)
  - [x] Labels associated with inputs
  - [x] aria-invalid on inputs with errors
  - [x] aria-label on show/hide password buttons
  - [x] LEGO-themed branding consistent with other auth pages

- [x] **Task 7: Unit Tests** (AC: 16)
  - [x] Create SignupPage.test.tsx
  - [x] Tests for form rendering (7 tests)
  - [x] Tests for field validation (4 tests)
  - [x] Tests for password strength indicator (4 tests)
  - [x] Tests for password match validation
  - [x] Tests for terms checkbox validation
  - [x] Tests for successful signup flow (4 tests)
  - [x] Tests for error handling (3 tests)
  - [x] Tests for loading state (2 tests)
  - [x] Tests for navigation links (6 tests)
  - [x] Tests for accessibility (5 tests)
  - [x] Tests for navigation tracking (4 tests)

## Dev Notes

### Existing Implementation

**File:** `apps/web/main-app/src/routes/pages/SignupPage.tsx`

### Amplify v6 Sign Up

```typescript
import { signUp } from 'aws-amplify/auth'

const result = await signUp({
  username: userData.email,
  password: userData.password,
  options: {
    userAttributes: {
      email: userData.email,
      name: userData.name,
    },
    autoSignIn: true, // Enable auto sign-in after confirmation
  },
})

if (result.isSignUpComplete) {
  // Signup complete (rare - usually requires email verification)
} else {
  // User needs to verify email
  navigate({ to: '/verify-email', search: { email } })
}
```

### Form Schema (Zod)

```typescript
const SignupSchema = z
  .object({
    name: z.string().min(2, 'Name must be at least 2 characters'),
    email: z.string().email('Please enter a valid email address'),
    password: z
      .string()
      .min(8, 'Password must be at least 8 characters')
      .regex(
        /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/,
        'Password must contain uppercase, lowercase, and number',
      ),
    confirmPassword: z.string(),
    acceptTerms: z
      .boolean()
      .refine(val => val === true, 'You must accept the terms and conditions'),
  })
  .refine(data => data.password === data.confirmPassword, {
    message: "Passwords don't match",
    path: ['confirmPassword'],
  })
```

### Password Strength Indicator

The component displays a 4-segment strength indicator:
- Weak: < 4 characters
- Fair: 4-5 characters
- Good: 6-7 characters
- Strong: 8+ characters

### @repo/ui Components Used

- Input (name, email, password, confirmPassword)
- Button (submit, back to home)
- Card (form container)
- Alert (success/error messages)
- Checkbox (terms acceptance)
- Label (form labels)

### Navigation Flow

1. User fills out form and submits
2. On success: Show success message, wait 2 seconds
3. Navigate to `/verify-email` with email in search params
4. Email verification page handles code entry

### Dependencies

- Story 1.13.3: Email Verification Flow (next step after signup)
- Story 1.14: Login Page (link from signup)

## Change Log

| Date       | Version | Description                                        | Author    |
| ---------- | ------- | -------------------------------------------------- | --------- |
| 2025-11-29 | 0.1     | Story created - implementation exists, needs tests | SM Agent  |
| 2025-11-29 | 1.0     | Complete: Added 43 unit tests                      | Dev Agent |
