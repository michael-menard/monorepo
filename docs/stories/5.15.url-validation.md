# Story 5.15: URL Validation

## Status

Approved

## Story

**As a** user,
**I want** URLs validated before saving,
**so that** I don't save invalid links.

## Acceptance Criteria

1. ⬜ URL format validation
2. ⬜ Must start with http:// or https://
3. ⬜ Clear error message
4. ⬜ Validates on blur and submit
5. ⬜ Allows common shop URLs

## Tasks / Subtasks

- [ ] **Task 1: Validation**
  - [ ] Zod URL validation
  - [ ] Custom error message

- [ ] **Task 2: UX**
  - [ ] Validate on blur
  - [ ] Show error immediately

## Dev Notes

```typescript
// URL validation in schema
const urlSchema = z.string()
  .url('Please enter a valid URL')
  .refine(
    (url) => url.startsWith('http://') || url.startsWith('https://'),
    'URL must start with http:// or https://'
  )

// Extended validation for known domains (optional)
const knownDomains = [
  'rebrickable.com',
  'bricklink.com',
  'lego.com',
  'bluebrixx.com',
  'webrick.com',
]

function isKnownDomain(url: string): boolean {
  try {
    const hostname = new URL(url).hostname
    return knownDomains.some(domain => hostname.includes(domain))
  } catch {
    return false
  }
}

// Helper tip in form
<FormDescription>
  Link to the product page (BrickLink, Rebrickable, LEGO.com, etc.)
</FormDescription>
```

## Change Log

| Date       | Version | Description   | Author   |
| ---------- | ------- | ------------- | -------- |
| 2025-11-28 | 0.1     | Initial draft | SM Agent |
