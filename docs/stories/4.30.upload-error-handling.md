# Story 4.30: Upload Error Handling

## Status

Approved

## Story

**As a** user,
**I want** clear feedback when uploads fail,
**so that** I can retry or take action.

## Acceptance Criteria

1. ⬜ Error state shown on failed upload
2. ⬜ Retry button available
3. ⬜ Clear error message
4. ⬜ Option to dismiss failed item
5. ⬜ Network error handling

## Tasks / Subtasks

- [ ] **Task 1: Error States**
  - [ ] Track upload errors
  - [ ] Display error UI

- [ ] **Task 2: Retry Logic**
  - [ ] Retry button
  - [ ] Re-attempt upload

## Dev Notes

```typescript
interface UploadItem {
  id: string
  file: File
  progress: number
  error?: string
}

function UploadItem({ item, onRetry, onDismiss }: UploadItemProps) {
  if (item.error) {
    return (
      <div className="p-3 bg-destructive/10 rounded-lg">
        <div className="flex items-center justify-between">
          <div className="flex items-center gap-2">
            <AlertCircle className="h-5 w-5 text-destructive" />
            <span className="font-medium">{item.file.name}</span>
          </div>
          <div className="flex gap-2">
            <Button variant="outline" size="sm" onClick={onRetry}>
              <RefreshCw className="mr-2 h-4 w-4" />
              Retry
            </Button>
            <Button variant="ghost" size="sm" onClick={onDismiss}>
              <X className="h-4 w-4" />
            </Button>
          </div>
        </div>
        <p className="text-sm text-destructive mt-1">{item.error}</p>
      </div>
    )
  }

  return <UploadProgress progress={item.progress} fileName={item.file.name} />
}

// Error messages
const UPLOAD_ERRORS = {
  network: 'Network error. Please check your connection.',
  timeout: 'Upload timed out. Please try again.',
  server: 'Server error. Please try again later.',
  unknown: 'Upload failed. Please try again.',
}
```

## Change Log

| Date       | Version | Description   | Author   |
| ---------- | ------- | ------------- | -------- |
| 2025-11-28 | 0.1     | Initial draft | SM Agent |
