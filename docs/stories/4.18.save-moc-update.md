# Story 4.18: Save MOC (Update)

## Status

Approved

## Story

**As a** user,
**I want** to save my MOC edits,
**so that** changes are persisted.

## Acceptance Criteria

1. ⬜ Save button updates existing MOC
2. ⬜ Uses updateMoc mutation
3. ⬜ Uploads new cover if changed
4. ⬜ Shows success toast
5. ⬜ Redirects to detail page

## Tasks / Subtasks

- [ ] **Task 1: Update Handler**
  - [ ] Check if edit mode
  - [ ] Call updateMoc mutation

- [ ] **Task 2: Cover Update**
  - [ ] Only upload if changed
  - [ ] Handle replacement

## Dev Notes

```typescript
const onSubmit = async (values: MocFormValues) => {
  try {
    if (isEdit && moc) {
      // Update existing
      await updateMoc({ id: moc.id, ...values }).unwrap()

      if (newCoverImage) {
        await uploadFile({ mocId: moc.id, file: newCoverImage, isCover: true }).unwrap()
      }

      toast.success('MOC updated successfully!')
    } else {
      // Create new (handled in 4.15)
    }

    onSuccess(moc)
  } catch (error) {
    toast.error('Failed to save MOC')
  }
}
```

## Change Log

| Date       | Version | Description   | Author   |
| ---------- | ------- | ------------- | -------- |
| 2025-11-28 | 0.1     | Initial draft | SM Agent |
