# Story 0.2.1: Playwright Tests - Forgot Password Flow

## GitHub Issue
- Issue: #328
- URL: https://github.com/michael-menard/monorepo/issues/328
- Status: Todo

## Status

Draft

## Story

**As a** QA engineer,
**I want** comprehensive Playwright tests for the forgot password flow,
**so that** we can ensure the password reset request functionality works correctly across all scenarios.

## Acceptance Criteria

1. ✅ Feature file created at `apps/web/playwright/features/auth/forgot-password.feature`
2. ✅ UI element scenarios verify all form components are present
3. ✅ Validation scenarios test email field validation
4. ✅ Happy path scenario tests successful password reset request
5. ✅ Navigation scenarios test links to login/signup pages
6. ✅ Button state scenarios test loading and disabled states
7. ✅ Step definitions implemented for all scenarios
8. ✅ Tests pass in CI/CD pipeline

## Tasks / Subtasks

- [ ] **Task 1: Create Forgot Password Feature File** (AC: 1)
  - [ ] Create `apps/web/playwright/features/auth/forgot-password.feature`
  - [ ] Add feature description and background
  - [ ] Follow existing auth feature file patterns

- [ ] **Task 2: Write UI Element Scenarios** (AC: 2)
  - [ ] Scenario: Forgot password page displays all required elements
  - [ ] Verify page title/heading
  - [ ] Verify email input field
  - [ ] Verify submit button
  - [ ] Verify back to login link

- [ ] **Task 3: Write Validation Scenarios** (AC: 3)
  - [ ] Scenario: Form validation with empty email
  - [ ] Scenario: Form validation with invalid email format
  - [ ] Scenario: Submit button disabled with invalid input

- [ ] **Task 4: Write Happy Path Scenarios** (AC: 4)
  - [ ] Scenario: Successful password reset request with valid email
  - [ ] Verify success message displayed
  - [ ] Verify redirect or next step indication

- [ ] **Task 5: Write Navigation Scenarios** (AC: 5)
  - [ ] Scenario: Navigate back to login page
  - [ ] Scenario: Navigate to signup page (if link exists)

- [ ] **Task 6: Write Button State Scenarios** (AC: 6)
  - [ ] Scenario: Submit button shows loading state during request
  - [ ] Scenario: Submit button disabled during submission

- [ ] **Task 7: Implement Step Definitions** (AC: 7)
  - [ ] Create or update step definition file in `apps/web/playwright/steps/`
  - [ ] Implement steps for forgot password page interactions
  - [ ] Reuse common steps where applicable

- [ ] **Task 8: Verify Tests Pass** (AC: 8)
  - [ ] Run tests locally
  - [ ] Verify all scenarios pass
  - [ ] Ensure tests run in CI/CD pipeline

## Dev Notes

### Existing Auth Test Patterns

Reference these existing feature files for consistent patterns:
- `apps/web/playwright/features/auth/login.feature` - UI, validation, navigation patterns
- `apps/web/playwright/features/auth/signup.feature` - Form validation patterns
- `apps/web/playwright/features/auth/email-verification.feature` - Button state patterns

### Step Definitions Location

Step definitions are located in:
- `apps/web/playwright/steps/` - Common and auth-specific steps
- Reuse existing steps from `common.steps.ts`, `login.steps.ts`, `signup.steps.ts`

### Testing Standards

**Test File Location:**
- Feature file: `apps/web/playwright/features/auth/forgot-password.feature`
- Step definitions: `apps/web/playwright/steps/forgot-password.steps.ts` (if new steps needed)

**Test Standards:**
- Use Gherkin syntax (Given/When/Then)
- Tag scenarios appropriately: `@auth`, `@forgot-password`, `@ui`, `@validation`, `@happy-path`, `@navigation`
- Follow BDD best practices
- Use descriptive scenario names
- Keep scenarios focused and atomic

**Testing Frameworks:**
- Playwright for browser automation
- Cucumber/Gherkin for BDD syntax
- playwright-bdd for integration

**Specific Requirements:**
- All scenarios must use semantic selectors (getByRole, getByLabel, getByText)
- Avoid brittle selectors (CSS classes, IDs unless necessary)
- Test both success and failure paths
- Verify accessibility (ARIA labels, keyboard navigation)

### Expected Feature File Structure

```gherkin
@auth @forgot-password
Feature: Forgot Password
  As a user who forgot their password
  I want to request a password reset
  So that I can regain access to my account

  Background:
    Given I am on the forgot password page

  @ui
  Scenario: Forgot password page displays all required elements
    # UI verification scenarios

  @validation
  Scenario: Form validation scenarios
    # Validation scenarios

  @happy-path
  Scenario: Successful password reset request
    # Success flow scenarios

  @navigation
  Scenario: Navigation scenarios
    # Navigation scenarios
```

## Change Log

| Date       | Version | Description   | Author   |
| ---------- | ------- | ------------- | -------- |
| 2025-12-21 | 0.1     | Initial draft | SM Agent |

