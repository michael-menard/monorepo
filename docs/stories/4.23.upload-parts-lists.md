# Story 4.23: Upload Parts Lists

## Status

Approved

## Story

**As a** user,
**I want** to upload parts list files,
**so that** I can track pieces needed.

## Acceptance Criteria

1. ⬜ Upload button in Parts Lists section
2. ⬜ Accept XML, CSV, JSON files
3. ⬜ Max size validation (5MB)
4. ⬜ Shows file format badge
5. ⬜ Progress indication

## Tasks / Subtasks

- [ ] **Task 1: Parts Upload**
  - [ ] Accept .xml, .csv, .json
  - [ ] Validate size

- [ ] **Task 2: Integration**
  - [ ] Upload mutation
  - [ ] Refresh list

## Dev Notes

```typescript
function PartsListUploader({ mocId }: { mocId: string }) {
  const [uploadFile] = useUploadFileMutation()
  const inputRef = useRef<HTMLInputElement>(null)
  const acceptedFormats = '.xml,.csv,.json'

  const handleFile = async (e: React.ChangeEvent<HTMLInputElement>) => {
    const file = e.target.files?.[0]
    if (!file) return

    if (file.size > 5 * 1024 * 1024) {
      toast.error('Parts list must be under 5MB')
      return
    }

    try {
      await uploadFile({ mocId, file }).unwrap()
      toast.success('Parts list uploaded')
    } catch {
      toast.error('Failed to upload parts list')
    }
  }

  return (
    <>
      <Button variant="outline" onClick={() => inputRef.current?.click()}>
        <List className="mr-2 h-4 w-4" />
        Upload Parts List
      </Button>
      <input
        type="file"
        ref={inputRef}
        accept={acceptedFormats}
        onChange={handleFile}
        hidden
      />
    </>
  )
}
```

## Change Log

| Date       | Version | Description   | Author   |
| ---------- | ------- | ------------- | -------- |
| 2025-11-28 | 0.1     | Initial draft | SM Agent |
