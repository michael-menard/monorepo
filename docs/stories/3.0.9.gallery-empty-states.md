# Story 3.0.9: Gallery Empty & Loading States

## Status

Ready for Review

## Story

**As a** user,
**I want** clear feedback when galleries are loading or empty,
**so that** I understand the current state and what actions to take.

## Acceptance Criteria

1. ⬜ GalleryEmptyState component for when no items exist
2. ⬜ GalleryNoResults component for when filters return no matches
3. ⬜ GallerySkeleton component for loading states
4. ⬜ Empty state includes call-to-action when appropriate
5. ⬜ No results state suggests clearing filters
6. ⬜ Skeleton matches grid layout structure

## Tasks / Subtasks

- [x] **Task 1: Empty State Component**
  - [x] Create `src/components/GalleryEmptyState.tsx`
  - [x] Configurable icon, title, description
  - [x] Optional action button slot

- [x] **Task 2: No Results Component**
  - [x] Create `src/components/GalleryNoResults.tsx`
  - [x] "No results found" messaging
  - [x] "Clear filters" button

- [x] **Task 3: Loading Skeleton**
  - [x] Create `src/components/GallerySkeleton.tsx`
  - [x] Match GalleryGrid responsive columns
  - [x] Configurable item count
  - [x] Use @repo/ui Skeleton primitives (updated GalleryGridSkeleton with columns prop)

## Dev Notes

### Empty State Component

```typescript
interface GalleryEmptyStateProps {
  icon?: React.ComponentType<{ className?: string }>
  title: string
  description?: string
  action?: {
    label: string
    onClick: () => void
  }
  className?: string
}

// Usage
<GalleryEmptyState
  icon={ImageIcon}
  title="No instructions yet"
  description="Upload your first MOC instructions to get started."
  action={{
    label: "Upload Instructions",
    onClick: () => navigate('/upload')
  }}
/>
```

### No Results Component

```typescript
interface GalleryNoResultsProps {
  searchTerm?: string
  hasFilters: boolean
  onClearFilters: () => void
  onClearSearch?: () => void
}

// Usage
<GalleryNoResults
  searchTerm={search}
  hasFilters={selectedTags.length > 0 || selectedTheme !== null}
  onClearFilters={handleClearFilters}
  onClearSearch={() => setSearch('')}
/>

// Renders:
// "No results found for 'castle'"
// "Try adjusting your search or filters"
// [Clear Search] [Clear Filters]
```

### Skeleton Component

```typescript
interface GallerySkeletonProps {
  count?: number        // default: 8
  columns?: {           // match GalleryGrid
    sm?: number
    md?: number
    lg?: number
    xl?: number
  }
  showFilters?: boolean // show filter bar skeleton too
}

// Usage
{isLoading ? (
  <GallerySkeleton count={12} showFilters />
) : items.length === 0 ? (
  <GalleryEmptyState {...emptyProps} />
) : (
  <GalleryGrid>{items.map(...)}</GalleryGrid>
)}
```

### Skeleton Card Structure

```typescript
function GalleryCardSkeleton() {
  return (
    <div className="rounded-lg border bg-card">
      <Skeleton className="aspect-[4/3] rounded-t-lg" />
      <div className="p-4 space-y-2">
        <Skeleton className="h-4 w-3/4" />
        <Skeleton className="h-3 w-1/2" />
      </div>
    </div>
  )
}
```

## Testing

- [x] Unit test: empty state renders icon, title, description
- [x] Unit test: action button calls onClick
- [x] Unit test: no results shows search term
- [x] Unit test: clear filters button works
- [x] Unit test: skeleton renders correct count
- [ ] Visual test: skeleton matches card dimensions

## Dev Agent Record

### Agent Model Used

claude-opus-4-5-20251101

### Completion Notes

- Created `GalleryEmptyState` component with configurable icon, title, description, and optional action button
- Created `GalleryNoResults` component with search term display, contextual messaging, and clear buttons
- Created `GallerySkeleton` wrapper that uses `GalleryCardSkeleton` and `GalleryGridSkeleton`
- Updated `GalleryGridSkeleton` in `@repo/app-component-library` to accept `columns` and `gap` props (backwards compatible)
- Added `renderCard` prop to `GalleryGridSkeleton` for custom card skeletons
- Exported new types: `GalleryGridSkeletonColumns`, `GalleryGridSkeletonProps`
- All 42 new tests pass (263 total in gallery package)
- Lint passes

### File List

**New Files:**
- `packages/core/gallery/src/components/GalleryEmptyState.tsx`
- `packages/core/gallery/src/components/GalleryNoResults.tsx`
- `packages/core/gallery/src/components/GallerySkeleton.tsx`
- `packages/core/gallery/src/__tests__/GalleryEmptyStates.test.tsx`

**Modified Files:**
- `packages/core/app-component-library/src/feedback/skeleton.tsx` - Added columns/gap props to GalleryGridSkeleton
- `packages/core/app-component-library/src/index.ts` - Exported new skeleton components and types
- `packages/core/gallery/src/index.ts` - Added exports for new components

### Debug Log References

None

## Change Log

| Date       | Version | Description   | Author   |
| ---------- | ------- | ------------- | -------- |
| 2025-11-30 | 0.1     | Initial draft | SM Agent |
| 2025-12-05 | 0.2     | Implementation complete | Dev Agent |
