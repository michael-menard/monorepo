# Story 3.1.1: Instructions Gallery Page Scaffolding

## Status

Approved

## Story

**As a** developer,
**I want** the Instructions Gallery page scaffolded,
**so that** users can browse their MOC instruction collection.

## Acceptance Criteria

1. ⬜ `apps/web/main-app/src/routes/instructions/` folder created
2. ⬜ InstructionsGalleryPage component renders
3. ⬜ Route `/instructions` configured in router
4. ⬜ Lazy loading configured for route
5. ⬜ Page uses @repo/gallery components
6. ⬜ Basic page layout with header and grid area

## Tasks / Subtasks

- [ ] **Task 1: Create Route Structure**
  - [ ] Create `routes/instructions/` folder
  - [ ] Create `routes/instructions/index.tsx` (route file)
  - [ ] Create `routes/instructions/-components/` for page-specific components

- [ ] **Task 2: Page Component**
  - [ ] Create InstructionsGalleryPage component
  - [ ] Import GalleryGrid, GalleryFilterBar from @repo/gallery
  - [ ] Add page title/header

- [ ] **Task 3: Router Configuration**
  - [ ] Add `/instructions` route to router
  - [ ] Configure lazy loading
  - [ ] Add to navigation menu

## Dev Notes

### Route Structure

```
apps/web/main-app/src/routes/
└── instructions/
    ├── index.tsx              # Main gallery route
    ├── $instructionId.tsx     # Detail page route (future)
    └── -components/
        └── InstructionCard.tsx  # Gallery-specific card
```

### Page Component

```typescript
// routes/instructions/index.tsx
import { createFileRoute } from '@tanstack/react-router'
import {
  GalleryGrid,
  GalleryFilterBar,
  GalleryEmptyState,
  GallerySkeleton,
  useGalleryUrl,
} from '@repo/gallery'
import { useGetInstructionsQuery } from '@/services/api'
import { InstructionCard } from './-components/InstructionCard'

export const Route = createFileRoute('/instructions/')({
  component: InstructionsGalleryPage,
})

function InstructionsGalleryPage() {
  const { state, updateUrl } = useGalleryUrl()

  // API query will be implemented in separate story
  const { data, isLoading } = useGetInstructionsQuery(state)

  return (
    <div className="container mx-auto py-6 space-y-6">
      <h1 className="text-2xl font-bold">My Instructions</h1>

      <GalleryFilterBar
        search={state.search}
        onSearchChange={(s) => updateUrl({ search: s })}
        tags={availableTags}
        selectedTags={state.tags}
        onTagsChange={(t) => updateUrl({ tags: t })}
        themes={availableThemes}
        selectedTheme={state.theme}
        onThemeChange={(t) => updateUrl({ theme: t })}
        sortOptions={sortOptions}
        selectedSort={state.sortField}
        onSortChange={(s, d) => updateUrl({ sortField: s, sortDirection: d })}
      />

      {isLoading ? (
        <GallerySkeleton count={12} />
      ) : data?.items.length === 0 ? (
        <GalleryEmptyState
          title="No instructions yet"
          description="Upload your first MOC instructions to start your collection."
          action={{
            label: "Upload Instructions",
            onClick: () => navigate({ to: '/instructions/upload' })
          }}
        />
      ) : (
        <GalleryGrid>
          {data?.items.map((instruction) => (
            <InstructionCard key={instruction.id} instruction={instruction} />
          ))}
        </GalleryGrid>
      )}
    </div>
  )
}
```

### Dependencies

- @repo/gallery (shared gallery components)
- @repo/ui (base UI components)
- TanStack Router (routing)

## Testing

- [ ] Route `/instructions` renders page
- [ ] Page shows loading skeleton initially
- [ ] Empty state shows when no data
- [ ] Grid renders when data present

## Change Log

| Date       | Version | Description   | Author   |
| ---------- | ------- | ------------- | -------- |
| 2025-11-30 | 0.1     | Initial draft | SM Agent |
