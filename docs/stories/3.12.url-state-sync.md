# Story 3.12: URL State Sync

## Status

Approved

## Story

**As a** user,
**I want** search/filters saved in the URL,
**so that** I can share or bookmark filtered views.

## Acceptance Criteria

1. ⬜ Search term in URL: ?q=search
2. ⬜ Tags in URL: ?tags=tag1,tag2
3. ⬜ Theme in URL: ?theme=Star%20Wars
4. ⬜ Page in URL: ?page=2
5. ⬜ URL updates on filter change
6. ⬜ Filters restored from URL on load

## Tasks / Subtasks

- [ ] **Task 1: URL Params Hook**
  - [ ] Read params on mount
  - [ ] Parse to filter state

- [ ] **Task 2: Sync to URL**
  - [ ] Update URL on changes
  - [ ] Use replaceState (no history)

- [ ] **Task 3: TanStack Router**
  - [ ] Use search params from router
  - [ ] Type-safe params

## Dev Notes

```typescript
// Using TanStack Router search params
export const Route = createFileRoute('/gallery')({
  validateSearch: search => ({
    q: (search.q as string) || '',
    tags: (search.tags as string)?.split(',').filter(Boolean) || [],
    theme: (search.theme as string) || null,
    page: Number(search.page) || 1,
  }),
})

function GalleryPage() {
  const { q, tags, theme, page } = Route.useSearch()
  const navigate = useNavigate()

  const updateFilters = (updates: Partial<FilterState>) => {
    navigate({
      search: prev => ({ ...prev, ...updates, page: 1 }),
      replace: true,
    })
  }
}
```

## Change Log

| Date       | Version | Description   | Author   |
| ---------- | ------- | ------------- | -------- |
| 2025-11-28 | 0.1     | Initial draft | SM Agent |
