# Story 1.20: Loading Animation

## Status

Ready for Review

## Story

**As a** user,
**I want** a branded loading animation,
**so that** I know the app is working during loads.

## Acceptance Criteria

1. ✅ LoadingPage component exists
2. ✅ LEGO-themed loading animation (4 colored bricks with bounce)
3. ✅ Centered in viewport (flex layout)
4. ✅ Optional loading text with animated dots
5. ✅ Smooth fade-in animation (Framer Motion)
6. ✅ Accessible (aria-busy, role="status", aria-live)

## Tasks / Subtasks

- [x] **Task 1: Verify Component Exists** (AC: 1)
  - [x] Check routes/pages/LoadingPage.tsx exists
  - [x] Review current implementation

- [x] **Task 2: Create LEGO Animation** (AC: 2)
  - [x] Design bouncing LEGO brick animation
  - [x] Use Framer Motion for animations
  - [x] Use brand colors (red, blue, yellow, green)

- [x] **Task 3: Layout & Animation** (AC: 3, 5)
  - [x] Center in viewport (flex layout)
  - [x] Add fade-in on mount (containerVariants)
  - [x] Add bounce effect for bricks

- [x] **Task 4: Loading Text** (AC: 4)
  - [x] Accept optional message prop
  - [x] Default to "Loading"
  - [x] Animate dots with wave effect

- [x] **Task 5: Accessibility** (AC: 6)
  - [x] Add role="status"
  - [x] Add aria-busy="true"
  - [x] Add aria-live="polite"
  - [x] Add aria-label with message

## Dev Notes

### Existing Implementation

**File:** `apps/web/main-app/src/routes/pages/LoadingPage.tsx`

### Component Structure

```typescript
interface LoadingPageProps {
  message?: string
}

export function LoadingPage({ message = 'Loading...' }: LoadingPageProps) {
  return (
    <div
      className="flex flex-col items-center justify-center min-h-screen"
      role="status"
      aria-busy="true"
      aria-live="polite"
    >
      <div className="animate-spin">
        {/* LEGO brick icon or animation */}
      </div>
      <p className="mt-4 text-muted-foreground">{message}</p>
    </div>
  )
}
```

### LEGO Brick Animation Ideas

1. **Spinning brick:** Single brick rotating
2. **Stacking bricks:** Bricks building up
3. **Pulsing logo:** Logo with pulse effect
4. **Bouncing studs:** LEGO studs bouncing

### CSS Animation Example

```css
@keyframes brick-spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

.loading-brick {
  animation: brick-spin 1s linear infinite;
}
```

### Testing

- Test component renders
- Test custom message displays
- Test accessibility attributes
- Visual test animation

## Story Wrap-Up

### What Was Implemented

1. **LEGO Brick Animation** (`LegoBrickAnimation`)
   - 4 colored bricks (red, blue, yellow, green) matching LEGO brand colors
   - Spring animation on mount with staggered delays
   - Continuous bounce animation for visual interest
   - LEGO stud detail on each brick
   - Configurable sizes (sm, md, lg)

2. **Loading Text** (`LoadingText`)
   - Customizable message prop
   - Animated dots with wave effect
   - Optional dots display

3. **LoadingPage Component**
   - Full accessibility support (role, aria-busy, aria-live, aria-label)
   - Two modes: centered animation or skeleton layout
   - Smooth fade-in/out with AnimatePresence
   - Used as pendingComponent for lazy-loaded routes

4. **LoadingSkeleton Component**
   - Minimal inline loading indicator
   - Accessibility attributes included
   - Screen reader text

### Test Results

```
✓ src/routes/__tests__/LoadingPage.test.tsx (22 tests)
✓ src/lib/__tests__/route-guards.test.ts (23 tests)
✓ src/routes/__tests__/router.test.ts (15 tests)

Test Files: 3 passed
Tests: 60 passed
```

### Files Modified

| File | Action |
|------|--------|
| `apps/web/main-app/src/routes/pages/LoadingPage.tsx` | **Enhanced** — LEGO animation, accessibility |
| `apps/web/main-app/src/routes/__tests__/LoadingPage.test.tsx` | **Created** — 22 tests |

## Change Log

| Date       | Version | Description   | Author   |
| ---------- | ------- | ------------- | -------- |
| 2025-11-28 | 0.1     | Initial draft | SM Agent |
