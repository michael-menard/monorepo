# Story 3.1.15: Routes & CTAs — Entry Points to Uploader

## Status

Implemented

## Story

As a user,
I want obvious ways to start uploading,
so I can reach the uploader quickly from Dashboard and Gallery.

## Acceptance Criteria

1. Routes

- /instructions/new (primary)
- /dashboard/mocs/upload (alias) → either same page or redirect to /instructions/new
- Protected via RouteGuards.protected; on 401 redirect back post-login.

2. CTAs

- Dashboard: "Upload Instructions" button → uploader route.
- Gallery: "Upload yours" CTA → uploader route.

3. Loading & a11y

- Lazy-load uploader module; show LoadingPage; CTA buttons accessible with keyboard and labels.

4. Tests

- Route integration: unauthenticated redirect/return; alias works; CTAs navigate correctly.

## Tasks / Subtasks

- [x] Add/verify routes in apps/web/main-app/src/routes
- [x] Add CTAs in Dashboard and Gallery modules
- [x] Tests under routes/**tests**

## Implementation Summary

### Routes (AC 1)

- `/instructions/new` route in `apps/web/main-app/src/routes/index.ts` (lines 274-293)
  - Protected with `beforeLoad` guard that redirects to `/login` with `redirect` search param
- `/dashboard/mocs/upload` alias route (lines 296-303)
  - Redirects to `/instructions/new`

### CTAs (AC 2)

- **Dashboard**: "Add MOC" button in `QuickActions.tsx` → `/instructions/new`
- **Dashboard**: "Add Your First MOC" button in `EmptyDashboard.tsx` → `/instructions/new`
- **Gallery**: "Upload yours" button added to `GalleryModule.tsx` header → `/instructions/new`

### Loading & a11y (AC 3)

- Lazy loading with `LoadingPage` as pending component
- Gallery CTA has `aria-label="Upload your own MOC instructions"`
- All CTAs are keyboard accessible (using `<Button asChild><Link>` pattern)

### Tests (AC 4)

- `apps/web/main-app/src/routes/__tests__/uploader-routes.test.tsx` (7 tests):
  - Route protection: redirects unauthenticated users to login with return param
  - Route protection: allows authenticated users
  - Alias route: redirects to /instructions/new
  - Dashboard CTAs: QuickActions and EmptyDashboard link to /instructions/new
  - Gallery CTA: Upload yours link to /instructions/new
  - Accessibility: Gallery CTA has proper aria-label

## Dev Notes

- Use @repo/ui Button; no barrel files; log navigation intents at info.

## Change Log

| Date       | Version | Description                      | Author |
| ---------- | ------- | -------------------------------- | ------ |
| 2025-12-06 | 0.1     | Initial draft (routes & CTAs)    | SM     |
| 2025-12-07 | 1.0     | Implemented: routes, CTAs, tests | Agent  |
