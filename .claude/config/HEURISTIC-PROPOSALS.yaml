# HEURISTIC-PROPOSALS.yaml
#
# Generated by: heuristic-evolver agent
# Purpose: Tier promotion/demotion proposals based on decision outcome analysis
# Schema: .claude/schemas/decision-outcome-schema.md
# Source: .claude/config/decision-classification.yaml
#
# IMPORTANT: These are PROPOSALS only. Do NOT auto-apply.
# Human review required before updating decision-classification.yaml.
#
# Workflow:
# 1. heuristic-evolver analyzes decision_outcome entries from KB
# 2. Computes success rate per pattern (minimum 5 samples)
# 3. Proposes promotions (>95% success) or demotions (<80% success)
# 4. Human reviews this file
# 5. Human manually updates decision-classification.yaml if approved
# 6. Archive this file to .claude/config/archive/HEURISTIC-PROPOSALS-{date}.yaml

schema_version: 1
generated_at: null  # ISO timestamp when heuristic evolver runs
analyzed_stories: []  # List of story IDs analyzed (e.g., ["WISH-2045", "WISH-2046", "API-042"])
total_decisions: 0  # Total decision outcomes processed

# Patterns proposed for tier promotion (higher autonomy)
# Promotion logic: success_rate > 95% → propose tier - 1 (single-step)
promotions: []
# Example promotion entry:
# - pattern: "loading.*state|skeleton"
#   current_tier: 3
#   proposed_tier: 2
#   success_rate: 0.957  # 95.7%
#   samples: 23
#   confirmed: 22
#   overridden: 1
#   modified: 0
#   rationale: "Users consistently accept loading state additions across UI stories. Pattern is well-understood and low-risk."
#   example_stories: ["WISH-2045", "WISH-2046", "DASH-103"]
#   first_seen: "2025-12-01"
#   last_seen: "2026-02-06"

# Patterns proposed for tier demotion (lower autonomy)
# Demotion logic:
#   - 50% <= success_rate < 80% → propose tier + 1 (single-step)
#   - success_rate < 50% → propose tier + 2 (two-step, severe)
demotions: []
# Example demotion entry:
# - pattern: "breaking.*api"
#   current_tier: 2
#   proposed_tier: 3
#   success_rate: 0.72  # 72%
#   samples: 8
#   confirmed: 5
#   overridden: 3
#   modified: 0
#   rationale: "Users frequently override API breaking change auto-decisions. Pattern requires more caution and human judgment."
#   example_stories: ["API-042", "API-055"]
#   first_seen: "2026-01-15"
#   last_seen: "2026-02-04"
#   severity: "moderate"  # moderate | severe

# Example severe demotion entry (success rate < 50%):
# - pattern: "credential|secret|api.*key"
#   current_tier: 2
#   proposed_tier: 4
#   success_rate: 0.45  # 45%
#   samples: 12
#   confirmed: 5
#   overridden: 7
#   modified: 0
#   rationale: "SEVERE: Less than 50% success rate. Users consistently override credential handling decisions. This is a destructive pattern that should always escalate."
#   example_stories: ["SEC-008", "SEC-012", "SEC-019"]
#   first_seen: "2025-11-20"
#   last_seen: "2026-02-05"
#   severity: "severe"  # Two-step demotion due to <50% success

# Patterns analyzed but not proposed for tier change
# Reason: success_rate between 80% and 95% (working as intended)
no_change_patterns: []
# Example no-change entry:
# - pattern: "file.*naming|directory.*structure"
#   current_tier: 1
#   success_rate: 0.867  # 86.7%
#   samples: 15
#   confirmed: 13
#   overridden: 2
#   modified: 0
#   reason: "Success rate between 80-95%, no change proposed. Pattern is working as intended."
#   example_stories: ["WISH-2047", "API-043", "DASH-105"]

# Patterns with insufficient samples (< 5)
insufficient_samples: []
# Example insufficient samples entry:
# - pattern: "new.*experimental.*pattern"
#   current_tier: 3
#   samples: 3
#   confirmed: 2
#   overridden: 1
#   reason: "Insufficient samples (3 < 5). Need more data before proposing tier change."
#   example_stories: ["EXP-001", "EXP-002"]

# Patterns with no decision outcomes yet
unmatched_patterns: []
# Example unmatched pattern entry:
# - pattern: "moonshot.*feature"
#   current_tier: 3
#   samples: 0
#   reason: "No decision outcomes found. Pattern has not been exercised yet."

# Analysis metadata
analysis_summary:
  total_patterns_analyzed: 0  # Total patterns in decision-classification.yaml
  patterns_with_sufficient_samples: 0  # Patterns with >= 5 samples
  promotions_proposed: 0
  demotions_proposed: 0
  no_change: 0
  insufficient_samples_count: 0
  unmatched_patterns_count: 0

  # Success rate distribution (for all patterns with sufficient samples)
  success_rate_distribution:
    excellent: 0  # >95%
    good: 0       # 80-95%
    poor: 0       # 50-80%
    severe: 0     # <50%

  # Tier distribution (current state)
  tier_distribution:
    tier_1: 0
    tier_2: 0
    tier_3: 0
    tier_4: 0
    tier_5: 0

  # Date range of analyzed data
  earliest_decision: null  # ISO timestamp
  latest_decision: null    # ISO timestamp

# Notes for human reviewer
review_notes: |
  This file contains proposals generated by the heuristic-evolver agent.

  BEFORE APPLYING:
  1. Review each promotion/demotion proposal
  2. Verify example stories make sense
  3. Check rationale aligns with project goals
  4. Consider domain-specific context (e.g., security patterns should stay high-tier)

  TO APPLY A PROPOSAL:
  1. Open .claude/config/decision-classification.yaml
  2. Find the pattern in the appropriate tier section
  3. Move it to the proposed tier section
  4. Update the tier number in the pattern metadata (if applicable)
  5. Commit with message: "refactor(autonomy): Apply heuristic proposal for pattern X"

  TO REJECT A PROPOSAL:
  1. Archive this file to .claude/config/archive/HEURISTIC-PROPOSALS-{date}.yaml
  2. Document rejection reason in the archive file
  3. Optionally: Add pattern to exclusion list in heuristic-evolver config

  AFTER APPLYING:
  1. Archive this file for audit trail
  2. Run /dev-implement-story with updated tier rules
  3. Monitor decision outcomes for the adjusted patterns
  4. Re-run heuristic-evolver after 10-20 new stories
