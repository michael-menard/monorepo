---
doc_type: story
title: "WISH-2003: Detail & Edit Pages"
story_id: WISH-2003
story_prefix: WISH
status: Done
phase: 3
created_at: "2026-01-24T02:00:00-07:00"
updated_at: "2026-01-24T02:00:00-07:00"
depends_on: [WISH-2001]
estimated_points: 5
pr_reference: "#350"
---

# WISH-2003: Detail & Edit Pages

## Goal

Allow users to view item details and edit any field.

## Feature

PATCH endpoint, detail page showing full item info, edit page with pre-populated form, RTK Query mutation.

## Phase

Phase 3: Core Features

## Status

✓ Done (PR #350)

## Acceptance Criteria

- [x] PATCH `/api/wishlist/:id` endpoint validates and updates item
- [x] Detail page shows: large image, all metadata, priority, tags, notes
- [x] Action buttons: Got It!, Edit, Delete, Back
- [x] Edit page with pre-populated form (all fields editable)
- [x] RTK Query mutation: `useUpdateWishlistItemMutation`
- [x] Optimistic update on save
- [x] Success toast on save
- [x] Navigation back to detail view after save

## Technical Details

### Backend (API)

**Location:** `apps/api/endpoints/wishlist/update/handler.ts`

**PATCH /api/wishlist/:id**

Updates specific wishlist item (partial update).

Request body: Partial `UpdateWishlistItemSchema`
```json
{
  "title": "string (optional)",
  "store": "enum (optional)",
  "setNumber": "string (optional)",
  "sourceUrl": "string (optional)",
  "imageUrl": "string (optional)",
  "price": "number (optional)",
  "currency": "string (optional)",
  "pieceCount": "number (optional)",
  "releaseDate": "ISO date (optional)",
  "tags": "string[] (optional)",
  "priority": "0-5 (optional)",
  "notes": "string (optional)"
}
```

Response: `200 OK` with updated item object

### Frontend (React)

**Locations:**
- `apps/web/app-wishlist-gallery/src/pages/ItemDetailPage.tsx`
- `apps/web/app-wishlist-gallery/src/pages/EditItemPage.tsx`

**Detail Page**

Shows:
- Large item image
- All metadata fields
- Store badge
- Price with currency
- Piece count
- Release date
- Tags
- Priority level
- Notes
- Action buttons: Got It!, Edit, Delete, Back

Layout: Two-column (image left, info right, or stacked on mobile)

**Edit Page**

- Pre-populated form with current values
- Same form component as WISH-2002
- Save button triggers PATCH mutation
- Cancel button returns to detail view
- Optimistic UI update on save

## Dependencies

- **Depends On:** WISH-2001 (gallery)
- **Can run in parallel with:** WISH-2002, WISH-2004
- **Unblocks:** WISH-2005 (UX Polish)

## Reuse Plan

- Reuse `WishlistForm` component from WISH-2002
- Use RTK Query mutation patterns
- Leverage detail page layout from Sets gallery if similar

## Test Coverage

**Backend Tests:**
- Update with single field
- Update with multiple fields
- Update non-existent item (404)
- Unauthorized update rejection

**Frontend Tests:**
- Detail page renders with item data
- Edit form pre-populated correctly
- Optimistic update in gallery
- Success toast
- Navigation after save

**E2E Tests:**
- User can view item detail
- User can edit item
- Changes appear immediately (optimistic)
- User is returned to detail view

## Definition of Done

- [x] PATCH endpoint created
- [x] Detail page implementation
- [x] Edit page implementation
- [x] Form pre-population
- [x] Optimistic updates
- [x] RTK mutation
- [x] Tests passing
- [x] Code reviewed and merged (PR #350)

## Notes

This story is already completed in PR #350. Included for completeness in story index.

## Token Budget

### Phase Summary

| Phase | Estimated | Actual | Delta | Notes |
|-------|-----------|--------|-------|-------|
| Implementation | ~20k | — | — | Already completed |
| Code Review | ~8k | — | — | — |
| **Total** | ~28k | — | — | Completed |

## Agent Log

Append-only.

| Timestamp (America/Denver) | Agent | Action | Outputs |
|---|---|---|---|
| 2026-01-24 02:00 | pm-bootstrap-generation-leader | Created story file | WISH-2003.md |
