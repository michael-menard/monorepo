---
doc_type: story
title: "WISH-2050: Compression Preview Comparison"
story_id: WISH-2050
story_prefix: WISH
status: backlog
follow_up_from: WISH-2022
phase: 5
created_at: "2026-01-29T00:00:00-07:00"
updated_at: "2026-01-29T00:00:00-07:00"
depends_on: [WISH-2022]
estimated_points: 3
---

# WISH-2050: Compression Preview Comparison

## Follow-up Context

**Parent Story:** WISH-2022: Client-side Image Compression
**Source:** QA Discovery Notes - Enhancement Opportunities
**Original Finding:** Compression preview comparison - Side-by-side or slider comparison of original vs compressed image. Helps users understand quality trade-offs and builds trust in compression feature.
**Category:** Enhancement Opportunity
**Impact:** Medium - improves user understanding and trust in compression
**Effort:** Medium - requires dual image preview and comparison UI

## Context

WISH-2022 implements automatic client-side image compression before S3 upload. While compression at 0.8 quality is generally acceptable for wishlist images, users may want to visually verify the quality trade-off before uploading.

During elaboration, a side-by-side or slider comparison was identified as an enhancement but marked out-of-scope for the MVP due to UI complexity. However, this feature can:
- Build user trust in the compression feature
- Help users understand the quality vs. file size trade-off
- Allow users to make informed decisions about the "High quality (skip compression)" toggle
- Reduce user concerns about image quality degradation

This enhancement adds a visual comparison tool without changing the compression algorithm or upload flow from WISH-2022.

## Goal

Provide a visual comparison of original vs. compressed images to help users understand quality trade-offs and build trust in the compression feature.

## Non-goals

- Not implementing advanced image editing tools (crop, rotate, filters)
- Not implementing pixel-level diff visualization
- Not implementing compression quality adjustment sliders (see WISH-2046 for presets)
- Not re-implementing the compression algorithm from WISH-2022
- Not implementing comparison for other file types

## Scope

**Components Affected:**
- `apps/web/app-wishlist-gallery/src/components/ImageComparisonPreview/` (new)
- `apps/web/app-wishlist-gallery/src/components/WishlistForm/index.tsx`
- `apps/web/app-wishlist-gallery/src/pages/AddItemPage.tsx`

**Packages Affected:**
- `apps/web/app-wishlist-gallery`

**New Dependencies:**
- `react-compare-slider` or similar comparison component library (optional)

## Acceptance Criteria

- [ ] AC1: After compression, form displays comparison UI showing both original and compressed images
- [ ] AC2: Comparison UI uses slider control to transition between original (left) and compressed (right) images
- [ ] AC3: File size labels display above each preview: "Original: X MB" and "Compressed: Y MB (Z% reduction)"
- [ ] AC4: Comparison dimensions display below slider: "Original: WxH px" and "Compressed: WxH px"
- [ ] AC5: Slider is keyboard accessible with arrow keys for fine-grained control
- [ ] AC6: Comparison view can be toggled on/off with "Show comparison" checkbox
- [ ] AC7: Comparison preference is saved to localStorage: `wishlist:preferences:showComparisonPreview`
- [ ] AC8: Comparison UI is responsive on mobile (vertical stack instead of slider below 768px breakpoint)
- [ ] AC9: Original image is cached in memory during compression; no re-fetch required
- [ ] AC10: Comparison UI includes tooltips explaining the quality trade-off
- [ ] AC11: Unit tests cover: ImageComparisonPreview component rendering, slider interaction, keyboard navigation, responsive layout
- [ ] AC12: Playwright E2E tests cover: comparison toggle persistence, slider interaction, mobile responsive layout

## Reuse Plan

- Builds on compressed image preview from WISH-2022
- Leverages existing image preview component patterns from WishlistForm
- Uses localStorage preference pattern from WISH-2022 ("High quality" toggle)
- Can reuse responsive design breakpoints from @repo/ui

## Architecture Notes

**Comparison UI Options:**

1. **Slider comparison (recommended)**:
   - Vertical divider with draggable handle
   - Shows both images simultaneously with adjustable split
   - Most intuitive for quality comparison

2. **Side-by-side comparison**:
   - Two images displayed next to each other
   - Simpler implementation but requires more screen space
   - Better for desktop, less suitable for mobile

3. **Toggle comparison**:
   - Single preview with "Show original" button
   - Minimal UI complexity but less effective for comparison

**Implementation approach:**
- Use CSS `clip-path` or `mask` for slider implementation
- Cache original File object in component state
- Generate object URLs for both original and compressed blobs
- Clean up object URLs on component unmount

**Mobile Considerations:**
- Vertical stack layout below 768px breakpoint
- Tap-to-toggle comparison instead of slider on small screens
- Preserve slider functionality on tablets

## Test Plan

### Happy Path

1. User selects high-resolution image (5MB)
2. Compression completes: "Image compressed: 5.2 MB â†’ 0.8 MB"
3. Comparison UI appears with slider at 50% position
4. User drags slider left/right to compare original vs. compressed
5. File size and dimensions labels update accordingly
6. User submits form with compressed image

### Error Cases

1. **Original image not cached**: If original File object is lost, disable comparison UI with message "Comparison unavailable"
2. **Object URL creation fails**: Fall back to single compressed preview
3. **Comparison toggle fails**: Gracefully disable comparison feature

### Edge Cases

1. **Small images (skip compression)**: Comparison UI not shown if compression was skipped
2. **Compression disabled**: Comparison UI not shown if "High quality" checkbox is checked
3. **Mobile layout**: Slider transitions to vertical stack on mobile
4. **Slow compression**: Comparison UI appears only after compression completes

## Risks / Edge Cases

1. **Memory overhead**: Caching original File object doubles memory usage during upload; acceptable for single-image uploads
2. **UI complexity on mobile**: Slider may be difficult to use on small screens; mitigate with tap-to-toggle fallback
3. **User confusion**: Side-by-side comparison may not clearly communicate the trade-off; use clear labels and tooltips
4. **Accessibility**: Slider must be keyboard accessible and screen reader friendly

## Open Questions

None - all requirements are clear and non-blocking.

---

## Notes from Elaboration

_To be filled during elaboration phase_
