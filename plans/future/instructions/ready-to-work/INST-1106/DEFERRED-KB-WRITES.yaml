# Deferred Knowledge Base Writes
# These writes should be retried when KB is available

deferred_at: "2026-02-08T12:00:00Z"
reason: "KB tools not available during story generation"

writes:
  - type: "stories"
    operation: "INSERT"
    data:
      story_id: "INST-1106"
      feature: "instructions"
      title: "Upload Parts List"
      story_dir: "plans/future/instructions/backlog/INST-1106"
      story_file: "plans/future/instructions/backlog/INST-1106/INST-1106.md"
      story_type: "feature"
      points: 3
      priority: "high"
      state: "backlog"
      touches_backend: true
      touches_frontend: true
      touches_database: true
      touches_infra: false
    sql: |
      INSERT INTO stories (
        story_id, feature, title, story_dir, story_file, story_type,
        points, priority, state, touches_backend, touches_frontend,
        touches_database, touches_infra
      ) VALUES (
        'INST-1106', 'instructions', 'Upload Parts List',
        'plans/future/instructions/backlog/INST-1106',
        'plans/future/instructions/backlog/INST-1106/INST-1106.md',
        'feature', 3, 'high', 'backlog',
        true, true, true, false
      )
      ON CONFLICT (story_id) DO UPDATE SET
        title = EXCLUDED.title,
        story_type = EXCLUDED.story_type,
        points = EXCLUDED.points,
        priority = EXCLUDED.priority,
        state = EXCLUDED.state,
        touches_backend = EXCLUDED.touches_backend,
        touches_frontend = EXCLUDED.touches_frontend,
        touches_database = EXCLUDED.touches_database,
        touches_infra = EXCLUDED.touches_infra,
        updated_at = NOW()
