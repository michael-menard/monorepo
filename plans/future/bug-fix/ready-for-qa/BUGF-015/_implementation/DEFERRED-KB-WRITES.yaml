# Deferred KB Writes - BUGF-015
# Generated by elab-autonomous-decider
# KB unavailable during autonomous elaboration - items logged here for manual KB entry

generated_at: "2026-02-11T20:15:00Z"
story_id: "BUGF-015"
kb_status: unavailable
total_deferred: 17

# Non-Blocking Gaps (7 items)
gaps:
  - id: 1
    finding: "E2E Test Coverage Gap"
    category: integration
    impact: Medium
    effort: High
    tags: ["future-work", "e2e", "integration", "bugf-030"]
    recommendation: |
      Add E2E tests for admin user management, upload flows, and form validation in BUGF-030
      (already planned). Unit tests provide adequate MVP coverage per ADR-006 (E2E optional
      during dev phase).

  - id: 2
    finding: "Visual Regression Testing Gap"
    category: integration
    impact: Low
    effort: Medium
    tags: ["future-work", "visual-regression", "percy", "chromatic"]
    recommendation: |
      Tests don't catch visual changes (styling, layout shifts). Add Percy/Chromatic in
      separate story after MVP (Q2 2026). Visual regression not in current test strategy.

  - id: 3
    finding: "Performance Testing Gap"
    category: performance
    impact: Low
    effort: Medium
    tags: ["future-work", "performance", "optimization"]
    recommendation: |
      Tests don't validate component render performance or memory usage. Add performance
      benchmarks in separate story after MVP. Not critical for unit test coverage story.

  - id: 4
    finding: "Test Coverage for Utility Functions"
    category: edge-case
    impact: Low
    effort: Medium
    tags: ["future-work", "coverage", "utilities"]
    recommendation: |
      Story focuses on component tests only. If 45% global coverage not reached, may need
      to add tests for utility functions, hooks, and service layers in src/lib/, src/hooks/,
      src/services/. Monitor coverage report after Phase 1-2.

  - id: 5
    finding: "Drag-and-Drop Testing Complexity"
    category: edge-case
    impact: Low
    effort: High
    tags: ["future-work", "drag-drop", "dnd-kit"]
    recommendation: |
      Story mentions "Complex drag-and-drop testing (if needed, create separate story)" but
      doesn't specify which components require drag testing. If module wrappers or upload
      components have drag interactions, may need specialized testing setup with
      @dnd-kit/testing-library. Defer until drag functionality confirmed.

  - id: 6
    finding: "Real API Integration Testing"
    category: integration
    impact: Low
    effort: High
    tags: ["future-work", "integration", "api-testing"]
    recommendation: |
      Unit tests use MSW mocks only. Real API integration testing covered by E2E/UAT, not
      unit tests. Consider adding integration test suite with real backend in future story
      (separate from unit tests and E2E).

  - id: 7
    finding: "Component Interaction Tests"
    category: edge-case
    impact: Medium
    effort: Medium
    tags: ["future-work", "interaction-testing", "user-flows"]
    recommendation: |
      Story covers component rendering and user interactions, but not component-to-component
      integration. Consider adding interaction tests (Testing Library's user-event v14
      interactions) for complex flows like admin user detail page → dialog → confirmation.
      Defer to post-MVP refinement.

# Enhancement Opportunities (10 items)
enhancements:
  - id: 1
    finding: "Test Coverage Dashboard"
    category: observability
    impact: Medium
    effort: Medium
    tags: ["enhancement", "observability", "codecov", "monitoring"]
    recommendation: |
      Add Codecov or similar coverage tracking dashboard to visualize coverage trends over
      time. Would help track progress toward 45% threshold and identify low-coverage areas.
      Recommend setting up in CI after MVP test coverage stories complete.

  - id: 2
    finding: "Mutation Testing"
    category: quality-assurance
    impact: High
    effort: High
    tags: ["enhancement", "quality", "mutation-testing", "stryker"]
    recommendation: |
      Add Stryker or similar mutation testing to validate test quality. Mutation testing
      ensures tests actually catch bugs (not just inflate coverage metrics). High value but
      significant setup effort. Recommend after achieving 45% coverage baseline.

  - id: 3
    finding: "Test Flakiness Monitoring"
    category: observability
    impact: Medium
    effort: Low
    tags: ["enhancement", "observability", "monitoring", "ci"]
    recommendation: |
      Add test result reporting to track flaky tests and slow tests over time. Would help
      maintain test suite health as coverage grows. Can be added to CI with minimal effort
      (GitHub Actions test reporters).

  - id: 4
    finding: "Component Accessibility Audits"
    category: ux-polish
    impact: High
    effort: Medium
    tags: ["enhancement", "accessibility", "a11y", "axe-core"]
    recommendation: |
      Add axe-core automated accessibility testing to component tests. Story requires manual
      ARIA attribute checks, but axe-core can catch additional a11y issues automatically.
      High value for accessibility-first design system.

  - id: 5
    finding: "Snapshot Testing"
    category: quality-assurance
    impact: Low
    effort: Low
    tags: ["enhancement", "testing", "snapshots"]
    recommendation: |
      Consider adding snapshot testing for component output stability. Story uses behavioral
      testing only (rendering, interactions, accessibility). Snapshots can catch unintended
      output changes but add maintenance burden. Evaluate after MVP.

  - id: 6
    finding: "Test Data Factory Pattern"
    category: ux-polish
    impact: Medium
    effort: Medium
    tags: ["enhancement", "maintainability", "test-data", "factories"]
    recommendation: |
      Extract test data generation into factory functions (e.g., createMockUser(),
      createMockUploadSession()). Would reduce test boilerplate and improve maintainability.
      Story reuses existing src/test/mocks.tsx but may benefit from more structured data
      factories as test suite grows.

  - id: 7
    finding: "Coverage Diff Reporting"
    category: observability
    impact: Medium
    effort: Low
    tags: ["enhancement", "observability", "ci", "pr-reporting"]
    recommendation: |
      Add PR coverage diff reporting to show coverage change in pull requests. Would make
      it easier to see if new code is adequately tested before merge. Can be added to CI
      with Codecov or similar tool.

  - id: 8
    finding: "Test Parallelization"
    category: performance
    impact: Low
    effort: Medium
    tags: ["enhancement", "performance", "ci", "optimization"]
    recommendation: |
      Split test suites across multiple CI runners to speed up test execution. Currently
      all main-app tests run in single job. As test suite grows beyond 24 components,
      parallelization may improve CI feedback time. Defer until test execution time becomes
      bottleneck.

  - id: 9
    finding: "Component Performance Benchmarks"
    category: performance
    impact: Low
    effort: High
    tags: ["enhancement", "performance", "benchmarking"]
    recommendation: |
      Add performance benchmarks for complex components (admin tables, upload lists with
      many files). Would help prevent performance regressions as components evolve. Not
      critical for MVP but valuable for high-traffic components.

  - id: 10
    finding: "Shared Test Utilities Package"
    category: integration
    impact: Medium
    effort: Medium
    tags: ["enhancement", "reusability", "bugf-043", "monorepo"]
    recommendation: |
      Extract common test setup from 5 apps' src/test/setup.ts into @repo/test-utils
      (relates to BUGF-043). Would create single source of truth for test mocks and
      configuration. Defer until test coverage stories complete to understand shared patterns.

# Prioritization for Manual KB Entry
priority_high:
  - "Gap 1: E2E Test Coverage (BUGF-030 already planned)"
  - "Enhancement 4: Component Accessibility Audits (aligns with design system mandate)"
  - "Enhancement 2: Mutation Testing (ensures test quality)"

priority_medium:
  - "Enhancement 1: Test Coverage Dashboard"
  - "Gap 7: Component Interaction Tests"
  - "Enhancement 6: Test Data Factory Pattern"
  - "Enhancement 10: Shared Test Utilities (BUGF-043)"

priority_low:
  - "Gap 2: Visual Regression Testing"
  - "Gap 3: Performance Testing"
  - "Gap 4: Utility Function Coverage"
  - "Gap 5: Drag-and-Drop Testing"
  - "Gap 6: Real API Integration Testing"
  - "Enhancement 3: Test Flakiness Monitoring"
  - "Enhancement 5: Snapshot Testing"
  - "Enhancement 7: Coverage Diff Reporting"
  - "Enhancement 8: Test Parallelization"
  - "Enhancement 9: Component Performance Benchmarks"

# Notes
notes: |
  All 17 non-blocking items are deferred to post-MVP work. Story focuses on achieving 45%
  coverage baseline with quality unit tests for 24 untested components. Most enhancements
  require significant setup effort and are better suited for dedicated stories after MVP
  test coverage is achieved.

  E2E testing (Gap 1) is already planned in BUGF-030 per ADR-006.
  Shared test utilities (Enhancement 10) relates to planned work in BUGF-043.
