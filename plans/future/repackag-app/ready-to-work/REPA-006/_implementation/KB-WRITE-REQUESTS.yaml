# KB Write Requests for REPA-006
# Generated by elab-autonomous-decider
# To be processed by kb-writer agent

story_id: "REPA-006"
source_stage: "elab"
category: "future-opportunities"
total_requests: 13

requests:
  - request_id: 1
    entry_type: "finding"
    title: "Automated Migration Script Template"
    content: |
      **Finding**: No automated migration script for future similar migrations
      **Category**: Tooling
      **Impact**: Low | **Effort**: Medium
      **Recommendation**: Create reusable migration script template for package consolidation stories (batch rename imports, verify grep, run tests)
      **Story Context**: REPA-006 (Migrate Upload Types to @repo/upload/types)
      **Related Pattern**: Similar migration stories planned (REPA-003, REPA-005)
    tags:
      - "tooling"
      - "migration"
      - "automation"
      - "future-work"
      - "repackag-app"

  - request_id: 2
    entry_type: "finding"
    title: "Deprecation Warning Usage Analytics"
    content: |
      **Finding**: Deprecation console.warn() lacks usage analytics
      **Category**: Observability
      **Impact**: Low | **Effort**: Low
      **Recommendation**: Add telemetry to deprecation warning (count imports) to know when safe to delete old package
      **Story Context**: REPA-006 (Migrate Upload Types to @repo/upload/types)
      **Use Case**: Track actual usage of deprecated @repo/upload-types to determine safe deletion timing
    tags:
      - "observability"
      - "deprecation"
      - "telemetry"
      - "future-work"
      - "repackag-app"

  - request_id: 3
    entry_type: "finding"
    title: "ESLint Rule for Deprecated Package Imports"
    content: |
      **Finding**: No eslint rule to prevent imports from deprecated packages
      **Category**: Edge Cases
      **Impact**: Medium | **Effort**: Medium
      **Recommendation**: Create custom eslint rule to flag @repo/upload-types imports after deprecation period
      **Story Context**: REPA-006 (Migrate Upload Types to @repo/upload/types)
      **Priority**: Medium - prevents regressions after grace period ends
    tags:
      - "edge-case"
      - "eslint"
      - "deprecation"
      - "future-work"
      - "repackag-app"

  - request_id: 4
    entry_type: "finding"
    title: "Package-Specific Test Coverage Thresholds"
    content: |
      **Finding**: Test coverage threshold is global minimum (45%) not per-module
      **Category**: Code Organization
      **Impact**: Low | **Effort**: Low
      **Recommendation**: Consider package-specific coverage targets for types packages (suggest 80%+ for schema validation)
      **Story Context**: REPA-006 (Migrate Upload Types to @repo/upload/types)
      **Rationale**: Schema validation code is critical and easier to test - higher coverage appropriate
    tags:
      - "testing"
      - "coverage"
      - "quality"
      - "future-work"
      - "repackag-app"

  - request_id: 5
    entry_type: "finding"
    title: "Zod Version Compatibility CI Check"
    content: |
      **Finding**: No Zod version compatibility CI check
      **Category**: Observability
      **Impact**: Low | **Effort**: Medium
      **Recommendation**: Add CI step to validate Zod schema compatibility across major versions (prevent future upgrade issues)
      **Story Context**: REPA-006 (Migrate Upload Types to @repo/upload/types)
      **Background**: Migration from Zod ^3.23.8 to 4.1.13 highlighted need for automated compatibility validation
    tags:
      - "observability"
      - "ci"
      - "zod"
      - "compatibility"
      - "future-work"
      - "repackag-app"

  - request_id: 6
    entry_type: "finding"
    title: "Types Directory Organizational Improvement"
    content: |
      **Finding**: Type file organization could be improved
      **Category**: Code Organization
      **Impact**: Medium | **Effort**: Low
      **Recommendation**: Consider further subdividing types/ into session/, upload/, slug/, edit/ subdirectories for better organization (future refactor)
      **Story Context**: REPA-006 (Migrate Upload Types to @repo/upload/types)
      **Current State**: 4 type files in flat types/ directory
    tags:
      - "code-organization"
      - "refactor"
      - "types"
      - "future-work"
      - "repackag-app"

  - request_id: 7
    entry_type: "finding"
    title: "Named Re-Exports for Better Tree-Shaking"
    content: |
      **Finding**: Barrel exports don't use named re-exports
      **Category**: UX Polish
      **Impact**: Low | **Effort**: Low
      **Recommendation**: Migrate from `export *` to explicit named re-exports in types/index.ts for better tree-shaking and IDE autocomplete
      **Story Context**: REPA-006 (Migrate Upload Types to @repo/upload/types)
      **Developer Experience**: Improves IDE autocomplete and reduces bundle size
    tags:
      - "ux-polish"
      - "developer-experience"
      - "exports"
      - "future-work"
      - "repackag-app"

  - request_id: 8
    entry_type: "finding"
    title: "Schema Documentation in Package README"
    content: |
      **Finding**: No schema documentation/examples in package README
      **Category**: UX Polish
      **Impact**: Medium | **Effort**: Low
      **Recommendation**: Add usage examples and schema documentation to @repo/upload README (help developers discover types)
      **Story Context**: REPA-006 (Migrate Upload Types to @repo/upload/types)
      **Priority**: Medium - low effort, high developer value for discoverability
    tags:
      - "ux-polish"
      - "documentation"
      - "developer-experience"
      - "future-work"
      - "repackag-app"

  - request_id: 9
    entry_type: "finding"
    title: "Automated Deletion Trigger for Deprecated Packages"
    content: |
      **Finding**: Deprecated package lacks automated deletion trigger
      **Category**: Tooling
      **Impact**: Low | **Effort**: Medium
      **Recommendation**: Add calendar reminder or GitHub issue template for post-deprecation cleanup (2 sprint cycles = specific date)
      **Story Context**: REPA-006 (Migrate Upload Types to @repo/upload/types)
      **Use Case**: Prevent deprecated packages from lingering indefinitely
    tags:
      - "tooling"
      - "deprecation"
      - "automation"
      - "future-work"
      - "repackag-app"

  - request_id: 10
    entry_type: "finding"
    title: "Codemod Script for Import Path Migration"
    content: |
      **Finding**: Migration guide in deprecated package is manual only
      **Category**: Tooling
      **Impact**: Low | **Effort**: Medium
      **Recommendation**: Create codemod script for automated import path migration (reduce manual error risk)
      **Story Context**: REPA-006 (Migrate Upload Types to @repo/upload/types)
      **Use Case**: 17 files require manual import updates - automation reduces human error
    tags:
      - "tooling"
      - "migration"
      - "codemod"
      - "automation"
      - "future-work"
      - "repackag-app"

  - request_id: 11
    entry_type: "finding"
    title: "Zod Schema Validation Performance Benchmarks"
    content: |
      **Finding**: No performance benchmarks for Zod schema validation
      **Category**: Performance
      **Impact**: Low | **Effort**: High
      **Recommendation**: Add benchmark suite for schema parsing/validation performance (useful for large file uploads)
      **Story Context**: REPA-006 (Migrate Upload Types to @repo/upload/types)
      **Rationale**: Upload workflows process large files - schema validation performance matters
    tags:
      - "performance"
      - "benchmarking"
      - "zod"
      - "future-work"
      - "repackag-app"

  - request_id: 12
    entry_type: "finding"
    title: "Conditional Exports for Browser vs Node"
    content: |
      **Finding**: Type exports don't specify export conditions (browser vs node)
      **Category**: Code Organization
      **Impact**: Low | **Effort**: Medium
      **Recommendation**: Add conditional exports in package.json for browser-specific vs node-specific types if needed
      **Story Context**: REPA-006 (Migrate Upload Types to @repo/upload/types)
      **Context**: Upload types may have different behaviors in browser (File API) vs node (fs)
    tags:
      - "code-organization"
      - "exports"
      - "browser"
      - "node"
      - "future-work"
      - "repackag-app"

  - request_id: 13
    entry_type: "finding"
    title: "JSDoc Comments on Exported Types"
    content: |
      **Finding**: No JSDoc comments on exported types
      **Category**: UX Polish
      **Impact**: Medium | **Effort**: Low
      **Recommendation**: Add JSDoc comments to all exported types/schemas for better IDE hover documentation
      **Story Context**: REPA-006 (Migrate Upload Types to @repo/upload/types)
      **Priority**: HIGH if time permits - low effort, high developer value
      **Developer Experience**: Significantly improves IDE IntelliSense and documentation
    tags:
      - "ux-polish"
      - "jsdoc"
      - "documentation"
      - "developer-experience"
      - "future-work"
      - "repackag-app"
      - "priority"

priority_order:
  - request_id: 13
    reason: "Low effort, high developer value - JSDoc for IDE documentation"
  - request_id: 8
    reason: "Low effort, helps discoverability - Schema documentation in README"
  - request_id: 3
    reason: "Medium effort, prevents regressions - ESLint rule for deprecated imports"
