---
# Story Risk Predictions: REPA-003
# Generated by: pm-story-risk-predictor (haiku)
# Mode: Heuristics-only (WKFL-006 patterns not available, KB not queried)
---

predictions:
  split_risk: 0.5
  # Base: (16 ACs - 3) * 0.1 = 1.3 (clamped to 1.0)
  # Complexity adjustments:
  # - Frontend + Backend: +0.2
  # - No database schema changes: +0.0
  # - No auth/security: +0.0
  # - Blocked by dependencies (REPA-001, REPA-002): -0.3 (can't start, lower urgency to split)
  # - Scope is consolidation (reducing code, not adding): -0.4
  # Final: 1.0 + 0.2 - 0.3 - 0.4 = 0.5

  review_cycles: 3
  # Base: 1
  # Scope keywords: frontend, backend, hooks, testing (4 keywords) → +1
  # Auth integration refactoring (dependency injection) → +1
  # File handle tracking edge case → +0
  # Total: 3 cycles expected

  token_estimate: 120000
  # Heuristic calculation (no similar stories available):
  # - 16 ACs * 2500 tokens/AC (hook migration is code-heavy) = 40,000
  # - Test migration and adaptation: +30,000
  # - Import path updates across apps: +15,000
  # - Dependency injection refactoring: +20,000
  # - Manual verification and debugging: +15,000
  # Total: 120,000 tokens

  confidence: low
  # Reasons:
  # - No similar stories loaded (KB not queried in this context)
  # - WKFL-006 patterns unavailable
  # - Heuristics-only mode
  # - Blocked dependencies add uncertainty to actual implementation timing

  similar_stories: []
  # No similar stories available (KB not queried)
  # Recommendation: Query KB for stories with tags: ['hook-migration', 'repackag', 'consolidation']

  generated_at: "2026-02-10T00:00:00Z"
  model: haiku
  wkfl_version: "007-v1"

# Notes for PM:
# - split_risk is MEDIUM (0.5) due to:
#   - High AC count (16)
#   - Dependency injection refactor required
#   - BUT: Scope is well-defined consolidation, not new features
# - review_cycles of 3 is typical for refactoring work with tests
# - token_estimate is conservative, may be lower if existing tests port cleanly
# - Confidence is LOW due to lack of historical data, consider padding estimates

# Risk Factors (extracted from seed):
risk_factors:
  - blocking_dependencies: ["REPA-001", "REPA-002"]
  - breaking_changes: "useUploaderSession API requires auth state params"
  - test_complexity: "1100+ lines of existing tests to migrate"
  - redux_refactor: "Dependency injection pattern needed for auth state"

# Recommendations:
recommendations:
  - "Wait for REPA-001 and REPA-002 completion before starting"
  - "Allocate extra time for Redux-to-DI refactoring (2-3 hours)"
  - "Consider splitting test migration into separate subtask if timeline is tight"
  - "Manual verification critical: test upload flows in both apps post-migration"
