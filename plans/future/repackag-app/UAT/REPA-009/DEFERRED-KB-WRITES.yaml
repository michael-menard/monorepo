# Deferred KB Writes - REPA-009
# Generated by elab-autonomous-decider when KB unavailable
# These entries should be written to KB when kb-writer becomes available

generated_at: "2026-02-10T23:45:00Z"
story_id: "REPA-009"
total_entries: 21

entries:
  # Non-blocking gaps from FUTURE-OPPORTUNITIES.md
  - id: 1
    entry_type: finding
    source_stage: elab
    category: future-opportunities
    subcategory: edge-case
    title: "renderDragHandle prop may be over-engineered for MVP"
    content: |
      - **Finding**: Story includes custom drag handle rendering (AC-4, AC-5) but no current consumers identified
      - **Impact**: Low
      - **Effort**: Medium
      - **Recommendation**: Consider deferring to future work if InspirationCard/AlbumCard don't need custom handles
      - **Decision**: Included in MVP as optional/advanced feature
    tags:
      - "repa-009"
      - "gallery-card"
      - "future-work"
      - "edge-case"

  - id: 2
    entry_type: finding
    source_stage: elab
    category: future-opportunities
    subcategory: edge-case
    title: "No error handling for invalid Zod schema values at runtime"
    content: |
      - **Finding**: Story validates props via Zod but doesn't specify behavior when invalid values passed at runtime
      - **Impact**: Low
      - **Effort**: Low
      - **Recommendation**: Add error boundaries or graceful fallbacks in future iteration
    tags:
      - "repa-009"
      - "gallery-card"
      - "error-handling"
      - "edge-case"

  - id: 3
    entry_type: finding
    source_stage: elab
    category: future-opportunities
    subcategory: ux-polish
    title: "No animation for checkbox selection state change"
    content: |
      - **Finding**: Checkbox immediately shows/hides Check icon
      - **Impact**: Low
      - **Effort**: Low
      - **Recommendation**: Consider adding micro-animation (fade-in, scale) for better UX. Not MVP-critical.
    tags:
      - "repa-009"
      - "gallery-card"
      - "ux-polish"
      - "animation"

  - id: 4
    entry_type: finding
    source_stage: elab
    category: future-opportunities
    subcategory: performance
    title: "Drag handle always renders even when not dragging"
    content: |
      - **Finding**: Drag handle button exists in DOM even when opacity-0
      - **Impact**: Low
      - **Effort**: Low
      - **Recommendation**: Could optimize by conditionally rendering on hover state, but minimal performance impact
    tags:
      - "repa-009"
      - "gallery-card"
      - "performance"
      - "optimization"

  - id: 5
    entry_type: finding
    source_stage: elab
    category: future-opportunities
    subcategory: accessibility
    title: "No keyboard shortcut for bulk select (Cmd/Ctrl+A)"
    content: |
      - **Finding**: Users must click each card individually in selection mode
      - **Impact**: Medium
      - **Effort**: Medium
      - **Recommendation**: Keyboard shortcut for "Select All" would improve power-user UX. Requires parent gallery context.
    tags:
      - "repa-009"
      - "gallery-card"
      - "accessibility"
      - "keyboard"
      - "enhancement"

  - id: 6
    entry_type: finding
    source_stage: elab
    category: future-opportunities
    subcategory: integration
    title: "No visual feedback during drag operation"
    content: |
      - **Finding**: Story adds drag handle UI but doesn't specify drag preview or active-dragging state
      - **Impact**: Medium
      - **Effort**: Medium
      - **Recommendation**: Likely handled by SortableGallery (REPA-007) but worth documenting
    tags:
      - "repa-009"
      - "gallery-card"
      - "drag-drop"
      - "ux-feedback"
      - "depends-on-repa-007"

  - id: 7
    entry_type: finding
    source_stage: elab
    category: future-opportunities
    subcategory: edge-case
    title: "selectionPosition and dragHandlePosition props ignored when both enabled"
    content: |
      - **Finding**: DEV-FEASIBILITY.md recommends fixed positions to avoid conflicts
      - **Impact**: Low
      - **Effort**: Low
      - **Recommendation**: If use cases emerge for flexible positioning, revisit in future iteration with conflict resolution logic
      - **Decision**: Fixed positions approved for MVP
    tags:
      - "repa-009"
      - "gallery-card"
      - "edge-case"
      - "design-decision"

  - id: 8
    entry_type: enhancement
    source_stage: elab
    category: future-opportunities
    subcategory: integration
    title: "Multi-select drag-and-drop"
    content: |
      - **Enhancement**: Allow dragging multiple selected cards simultaneously
      - **Impact**: High
      - **Effort**: High
      - **Recommendation**: Requires SortableGallery (REPA-007) + custom drag preview. High user value for gallery reorganization. Track for REPA-010.
    tags:
      - "repa-010"
      - "gallery"
      - "drag-drop"
      - "multi-select"
      - "high-value"

  - id: 9
    entry_type: enhancement
    source_stage: elab
    category: future-opportunities
    subcategory: ux-polish
    title: "Undo/redo for card reordering"
    content: |
      - **Enhancement**: After drag-and-drop, provide undo button to restore previous order
      - **Impact**: Medium
      - **Effort**: Medium
      - **Recommendation**: Requires state management in parent gallery. Track for REPA-010 or later.
    tags:
      - "repa-010"
      - "gallery"
      - "undo-redo"
      - "state-management"

  - id: 10
    entry_type: enhancement
    source_stage: elab
    category: future-opportunities
    subcategory: accessibility
    title: "Keyboard reordering via drag handle"
    content: |
      - **Enhancement**: Allow keyboard users to reorder cards (focus drag handle, press arrow keys to move)
      - **Impact**: Medium
      - **Effort**: High
      - **Recommendation**: WCAG best practice. Requires SortableGallery keyboard support. Track for REPA-010.
    tags:
      - "repa-010"
      - "gallery"
      - "accessibility"
      - "keyboard"
      - "wcag"

  - id: 11
    entry_type: enhancement
    source_stage: elab
    category: future-opportunities
    subcategory: ux-polish
    title: "Custom selection checkbox styles"
    content: |
      - **Enhancement**: Allow custom checkbox render prop for brand variations
      - **Impact**: Low
      - **Effort**: Medium
      - **Recommendation**: Story hardcodes checkbox style (rounded-full, border-2, Check icon). Low priority unless design system evolves.
    tags:
      - "gallery-card"
      - "design-system"
      - "customization"
      - "low-priority"

  - id: 12
    entry_type: enhancement
    source_stage: elab
    category: future-opportunities
    subcategory: integration
    title: "Batch actions toolbar for selected cards"
    content: |
      - **Enhancement**: When cards selected, show floating action bar (Delete, Move to Album, Add Tags)
      - **Impact**: High
      - **Effort**: Medium
      - **Recommendation**: Requires parent gallery component. High user value. Track for REPA-010+.
    tags:
      - "repa-010"
      - "gallery"
      - "batch-actions"
      - "high-value"

  - id: 13
    entry_type: enhancement
    source_stage: elab
    category: future-opportunities
    subcategory: ux-polish
    title: "Selection count badge"
    content: |
      - **Enhancement**: Show "X selected" badge when in selection mode
      - **Impact**: Low
      - **Effort**: Low
      - **Recommendation**: Simple visual feedback. Add to GalleryFilterBar or parent gallery in future iteration. Quick win.
    tags:
      - "gallery"
      - "selection"
      - "ux-feedback"
      - "quick-win"

  - id: 14
    entry_type: enhancement
    source_stage: elab
    category: future-opportunities
    subcategory: ux-polish
    title: "Hover overlay fade-in delay"
    content: |
      - **Enhancement**: Add 100-200ms delay to avoid flicker on quick mouse movements
      - **Impact**: Low
      - **Effort**: Low
      - **Recommendation**: Current hover overlay has no delay (group-hover:opacity-100). Polish for future.
    tags:
      - "gallery-card"
      - "ux-polish"
      - "animation"

  - id: 15
    entry_type: enhancement
    source_stage: elab
    category: future-opportunities
    subcategory: accessibility
    title: "Accessible selection count announcement"
    content: |
      - **Enhancement**: When cards selected, announce "X items selected" to screen readers
      - **Impact**: Medium
      - **Effort**: Low
      - **Recommendation**: Use useAnnouncer from @repo/accessibility. Good a11y enhancement for future. Quick win.
    tags:
      - "gallery"
      - "accessibility"
      - "screen-reader"
      - "quick-win"

  - id: 16
    entry_type: enhancement
    source_stage: elab
    category: future-opportunities
    subcategory: accessibility
    title: "Touch-optimized drag gestures"
    content: |
      - **Enhancement**: On mobile, consider touch-swipe gestures for reordering
      - **Impact**: Medium
      - **Effort**: High
      - **Recommendation**: Drag handle requires precision on mobile. Swipe right to select, long-press to drag. Requires user research.
    tags:
      - "gallery"
      - "mobile"
      - "accessibility"
      - "touch-gestures"
      - "ux-research"

  - id: 17
    entry_type: enhancement
    source_stage: elab
    category: future-opportunities
    subcategory: integration
    title: "Selection persistence across page navigation"
    content: |
      - **Enhancement**: When user selects cards and navigates away, selection state is lost
      - **Impact**: Medium
      - **Effort**: Medium
      - **Recommendation**: Persist in URL params or session storage for better UX. Track for REPA-010+.
    tags:
      - "gallery"
      - "state-management"
      - "persistence"
      - "ux-enhancement"

  - id: 18
    entry_type: enhancement
    source_stage: elab
    category: future-opportunities
    subcategory: ux-polish
    title: "Drag handle position based on card aspect ratio"
    content: |
      - **Enhancement**: Auto-position drag handle based on card aspect ratio
      - **Impact**: Low
      - **Effort**: Medium
      - **Recommendation**: For vertical cards (tall aspect), drag handle at top-right may be awkward. Low priority unless UX feedback indicates issue.
    tags:
      - "gallery-card"
      - "responsive"
      - "ux-polish"
      - "low-priority"

  - id: 19
    entry_type: enhancement
    source_stage: elab
    category: future-opportunities
    subcategory: ux-polish
    title: "Hover overlay gradient customization"
    content: |
      - **Enhancement**: Allow custom gradient via prop for brand variations
      - **Impact**: Low
      - **Effort**: Low
      - **Recommendation**: Story hardcodes gradient (from-black/60 via-transparent to-transparent). Future: allow custom gradient prop.
    tags:
      - "gallery-card"
      - "design-system"
      - "customization"
      - "low-priority"

  - id: 20
    entry_type: enhancement
    source_stage: elab
    category: future-opportunities
    subcategory: ux-polish
    title: "Selection mode toggle animation"
    content: |
      - **Enhancement**: Add fade-in animation when entering/exiting selection mode
      - **Impact**: Low
      - **Effort**: Low
      - **Recommendation**: Checkboxes appear instantly. Consider fade-in animation for smoother transition. Polish for future.
    tags:
      - "gallery-card"
      - "animation"
      - "ux-polish"
      - "low-priority"

  - id: 21
    entry_type: enhancement
    source_stage: elab
    category: future-opportunities
    subcategory: edge-case
    title: "Drag handle touch target verification in CI"
    content: |
      - **Enhancement**: Add automated visual regression test for touch target size
      - **Impact**: Low
      - **Effort**: Medium
      - **Recommendation**: AC-6 requires 44x44px touch target but relies on manual testing. Add Playwright test with getBoundingClientRect to verify in CI.
    tags:
      - "gallery-card"
      - "testing"
      - "accessibility"
      - "ci-automation"
      - "wcag"

prioritization:
  quick_wins:
    - "Selection count badge (id: 13)"
    - "Accessible selection count announcement (id: 15)"
    - "Checkbox animation (id: 3)"
    - "Hover overlay fade-in delay (id: 14)"
    - "Selection mode toggle animation (id: 20)"

  high_impact_high_effort:
    - "Multi-select drag-and-drop (id: 8)"
    - "Batch actions toolbar (id: 12)"
    - "Keyboard reordering (id: 10)"
    - "Touch-optimized drag gestures (id: 16)"

  medium_priority:
    - "Undo/redo for card reordering (id: 9)"
    - "Selection persistence across page navigation (id: 17)"

  low_priority:
    - "Custom checkbox styles (id: 11)"
    - "Drag handle position based on aspect ratio (id: 18)"
    - "Hover overlay gradient customization (id: 19)"
    - "Drag handle touch target verification in CI (id: 21)"

notes:
  - "Most enhancements require parent gallery context (SortableGallery, GalleryFilterBar, or page-level state)"
  - "Track as part of REPA-010 (app-inspiration-gallery refactor) rather than standalone stories"
  - "Multi-select drag-and-drop has high user value but requires REPA-007 support"
  - "Keyboard reordering is WCAG best practice - prioritize for accessibility compliance"
