---
doc_type: plan_exec
title: REVI — Execution Plan
status: active
story_prefix: REVI
created_at: 2026-02-01T00:00:00Z
updated_at: 2026-02-01T00:00:00Z
tags:
  - workflow-hardening
  - execution
---

# REVI — Execution Plan

## Story Prefix

All stories use the **REVI** prefix. Commands use the full prefixed ID:

```bash
/pm-generate-story REVI-001
/elab-story REVI-001
/dev-implement-story REVI-001
/qa-verify-story REVI-001
```

## Artifact Rules

- Each story outputs artifacts under: `plans/stories/REVI-XXX/`
- A story folder is the source of truth for all related documentation
- Story docs MUST include:
  - YAML front matter with status
  - A Token Budget section
  - An append-only Agent Log section

## Artifact Naming Convention

| Artifact | Filename | Pattern |
|----------|----------|---------|
| Story file | `REVI-XXX.md` | Generated by PM |
| Elaboration | `ELAB-REVI-XXX-YYYYMMDD-HHMM.md` | PM elaboration output |
| Proof | `PROOF-REVI-XXX-YYYYMMDD-HHMM.md` | Dev implementation proof |
| Code Review | `CODE-REVIEW-REVI-XXX-YYYYMMDD-HHMM.md` | Review agent output |
| QA Verify | `QA-VERIFY-REVI-XXX-YYYYMMDD-HHMM.md` | QA verification output |
| QA Gate | `QA-GATE-REVI-XXX.yaml` | Final gate decision |

Timestamp format: `YYYYMMDD-HHMM` (America/Denver)

## Token Budget Rule

- Each story MUST include a `## Token Budget` section
- Before starting a phase, record `/cost` session total
- After completing a phase, record delta
- Enforcement levels: `advisory` (default), `warning`, `soft_gate`, `hard_gate`
- Per-story multiplier: `token_budget_multiplier: 1.5` in story frontmatter

## Step 0 — Harness Validation (if applicable)

- Produce Story 000 as a structural harness to validate the workflow
- Commit outputs to: `plans/stories/REVI-000/`
- Use for testing bootstrap process and artifact generation

## Subsequent Steps

- Each phase generates a new story directory
- No loose story markdown files at root of `plans/`
- All story directories follow naming convention: `REVI-XXX`

### Reuse Gate (Required for QA PASS)

For each story:
- PM story doc MUST include: `## Reuse Plan`
  - List which workspace packages are reused
  - List which packages are extended
  - Justify any new utilities created
- Dev proof MUST include: `## Reuse Verification`
  - Confirm packages used match reuse plan
  - Document any reuse plan changes with justification

### Story Acceptance Rule

A story may be marked "Done" only if:
- It reuses shared packages where applicable, OR
- It documents why reuse was not possible and creates the shared package instead
- All code passes linting, type checking, and tests
- All artifacts follow naming conventions
- Token budget is recorded accurately

## Phase Breakdown

### Phase 1: Foundation & Synchronization (5 stories)

**Stories:** REVI-001 through REVI-005

**Deliverables:**
1. Synchronization infrastructure (pre-commit hook, CI check, doc generation scripts)
2. Error contracts in TypeScript
3. Error contracts documented in Claude workflow
4. Parallel worker synchronization schema
5. Parallel worker documentation

**Gates:**
- All sync scripts pass linting and tests
- Pre-commit hook runs without errors
- CI workflow completes successfully
- Error schema validated against current command code

### Phase 2: Core Workflow Hardening (6 stories)

**Stories:** REVI-006 through REVI-011

**Deliverables:**
1. Complete state machine (17 statuses, all transitions)
2. State machine documentation in Claude workflow
3. Token budget enforcement schema
4. Token budget documentation and /token-log update
5. Idempotency schema and phase locking
6. Idempotency documentation in Claude workflow

**Gates:**
- State machine schema covers all 17 statuses
- No invalid transitions possible
- Token budget enforcement tested with actual token counts
- Idempotency locks prevent concurrent execution
- All documentation passes link checker

### Phase 3: Observability & Quality (4 stories)

**Stories:** REVI-012 through REVI-015

**Deliverables:**
1. Centralized model assignments (YAML config + TypeScript consumer)
2. Observability infrastructure (tracer and metrics)
3. Observability documentation in Claude workflow
4. Test fixtures and testing guidance

**Gates:**
- Model assignments audit complete and centralized
- Trace events are parseable as JSONL
- Metrics aggregation tested with real workflow execution
- Test fixtures cover unit, integration, and regression scenarios

---

## Agent Log

Append-only.

| Timestamp (America/Denver) | Agent | Action | Outputs |
|---|---|---|---|
| 2026-02-01T00:00:00Z | pm-bootstrap-generation-leader | Initial execution plan | REVI.plan.exec.md |
