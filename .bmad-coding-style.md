# BMad Development Agent - Coding Style & Rules

## ğŸ¯ **Core Principles**
- **Quality Gates**: All code must pass build âœ… TypeScript âœ… tests âœ… linter âœ…
- **Test-Driven Development**: Write comprehensive tests, aim for high coverage
- **LEGO-Inspired Design**: Teal/sky color palette, accessibility-first, responsive design
- **Monorepo Architecture**: Turbo-powered workspace with shared packages

## ğŸ“ **Code Style (Auto-enforced)**

### **Prettier Configuration**
```json
{
  "semi": false,                    // No semicolons
  "singleQuote": true,             // Single quotes
  "trailingComma": "all",          // Always trailing commas
  "printWidth": 100,               // 100 char line length
  "tabWidth": 2,                   // 2 spaces
  "arrowParens": "avoid",          // x => x (not (x) => x)
  "endOfLine": "lf"                // Unix line endings
}
```

### **ESLint Key Rules**
- `@typescript-eslint/no-explicit-any`: OFF (any is allowed)
- `no-console`: WARN (not error)
- `prefer-const`: ERROR
- Import order: builtin â†’ external â†’ internal â†’ parent â†’ sibling â†’ index
- React hooks rules disabled (ESLint 9 compatibility)

## ğŸ—ï¸ **Architecture Patterns**

### **File Structure**
```
apps/web/main-app/src/
â”œâ”€â”€ components/           # Reusable UI components
â”‚   â”œâ”€â”€ Auth/            # Authentication components
â”‚   â”œâ”€â”€ Layout/          # Layout components
â”‚   â””â”€â”€ Navigation/      # Navigation components
â”œâ”€â”€ pages/               # Page components
â”œâ”€â”€ routes/              # TanStack Router configuration
â”œâ”€â”€ services/            # Business logic & API calls
â”œâ”€â”€ store/               # Redux Toolkit state management
â”œâ”€â”€ hooks/               # Custom React hooks
â”œâ”€â”€ types/               # TypeScript type definitions
â””â”€â”€ test/                # Test utilities & mocks
```

### **Component Patterns**
- **Functional Components**: Always use function declarations (functional style preferred)
- **Props Types**: Use Zod schemas for props validation over TypeScript interfaces
- **Export Pattern**: Named exports preferred over default exports
- **No Barrel Files**: Avoid index.ts re-exports, import directly from source files
- **Styling**: Tailwind CSS with shadcn/ui components (import from @repo/ui)
- **State Management**: Redux Toolkit for global state, React hooks for local state

### **Import & Logging Patterns**
- **shadcn/ui Components**: ALWAYS import from @repo/ui package
  ```typescript
  // âœ… Correct
  import { Button, Card, Table } from '@repo/ui'

  // âŒ Wrong
  import { Button } from '@repo/ui/button'
  import { Card } from '@repo/ui/card'
  ```
- **Logging**: ALWAYS use @repo/logger instead of console.log
  ```typescript
  // âœ… Correct
  import { logger } from '@repo/logger'
  logger.info('User action completed')
  logger.error('API call failed', { error })

  // âŒ Wrong
  console.log('User action completed')
  console.error('API call failed', error)
  ```

### **Testing Patterns**
- **Framework**: Vitest + React Testing Library
- **Coverage**: Minimum 45% global, 100% for critical files
- **Mocking**: Comprehensive mocks in `src/test/setup.ts`
- **Test Structure**: Describe blocks for components, nested describes for features
- **Assertions**: Prefer semantic queries (getByRole, getByLabelText)
- **Validation**: Use Zod schemas for runtime validation and type inference

## ğŸ¨ **Design System**

### **LEGO-Inspired Theme**
- **Primary Colors**: Sky (500-600) and Teal (500-600)
- **Gradients**: `from-sky-500 to-teal-500`
- **Shadows**: `shadow-lg`, `shadow-xl` for depth
- **Animations**: Framer Motion for LEGO-like building animations
- **Typography**: Bold headings, readable body text

### **Accessibility Requirements**
- ARIA labels on all interactive elements
- Keyboard navigation support
- Screen reader compatibility
- Color contrast compliance
- Focus management

## ğŸ”§ **Development Workflow**

### **Package Management**
- **Tool**: pnpm (workspace protocol)
- **Rule**: Always use package managers, never edit package.json manually
- **Dependencies**: Workspace packages use `workspace:*`

### **Git & Quality**
- **Commits**: Conventional commits preferred
- **Pre-push**: Automated linting, type checking, and testing
- **Branches**: Feature branches, main branch protected

### **Performance**
- **Bundle Analysis**: Vite bundle analyzer
- **Code Splitting**: Route-based splitting with TanStack Router
- **Caching**: Redux Toolkit Query for API caching
- **Optimization**: Tree shaking, lazy loading

## ğŸš¨ **Common Pitfalls to Avoid**
1. **Don't** manually edit package.json - use pnpm commands
2. **Don't** ignore TypeScript errors - fix them
3. **Don't** skip tests - maintain coverage thresholds
4. **Don't** use `any` without consideration (though it's allowed)
5. **Don't** forget accessibility attributes
6. **Don't** hardcode colors - use Tailwind classes
7. **Don't** ignore ESLint warnings - address them
8. **Don't** create barrel files (index.ts re-exports) - import directly
9. **Don't** use TypeScript interfaces when Zod schemas provide better validation
10. **Don't** import shadcn components from individual paths - use @repo/ui package
11. **Don't** use console.log - use @repo/logger for all logging

## ğŸ“¦ **Key Dependencies**
- **React 19**: Latest React with concurrent features
- **TanStack Router**: Type-safe routing
- **Redux Toolkit**: State management
- **shadcn/ui (@repo/ui)**: Component library - ALWAYS import from @repo/ui package
- **Logger (@repo/logger)**: Centralized logging - ALWAYS use instead of console.log
- **Tailwind CSS**: Utility-first styling
- **Framer Motion**: Animations
- **AWS Amplify**: Authentication
- **Vitest**: Testing framework
- **Zod**: Schema validation and type inference (preferred over TypeScript interfaces)
