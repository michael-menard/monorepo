# <!-- Powered by BMAD™ Core -->
workflow:
  id: epic-explosion
  name: Epic Explosion (Parallel Story Creation)
  description: >-
    Coordinate multiple sm-story-worker sub-agents to create all epic stories
    in parallel, ensuring comprehensive coverage and consistency.
  type: parallel-execution
  
  use_cases:
    - Large epic with many stories (8+ stories)
    - Time-sensitive story creation
    - Consistent story quality across epic
    - Comprehensive epic coverage validation
    
  prerequisites:
    - Epic is defined in sharded PRD
    - Epic requirements are clear
    - Story boundaries can be identified
    - No critical dependencies on external epics
    
  phases:
    - phase: initialization
      agent: sm-coordinator
      steps:
        - step: load_epic_definition
          action: Read epic from sharded PRD
          validates:
            - Epic exists
            - Requirements are clear
            - Scope is defined
            
        - step: identify_story_boundaries
          action: Analyze epic and identify individual stories
          outputs:
            - Story count
            - Story scopes
            - Story titles (draft)
            - Story dependencies
            
        - step: validate_parallelization
          action: Ensure stories can be created in parallel
          checks:
            - Stories have clear boundaries
            - Minimal inter-story dependencies
            - No circular dependencies
            
        - step: create_execution_plan
          action: Plan story creation order
          considers:
            - Story dependencies
            - Story complexity
            - Worker allocation
          outputs:
            - Worker assignments
            - Story numbering
            - Dependency order
            
    - phase: worker_spawning
      agent: sm-coordinator
      steps:
        - step: spawn_story_workers
          action: Create sm-story-worker for each story
          for_each: story in execution_plan
          executes: spawn-sub-agent task
          creates:
            - Worker state file
            - Task assignment with story scope
            - Story number assignment
            
        - step: initialize_workers
          action: Workers load epic context and begin
          worker_actions:
            - Load task assignment
            - Read epic definition
            - Understand assigned scope
            - Report initialization complete
            
    - phase: parallel_creation
      agent: sm-coordinator
      steps:
        - step: monitor_progress
          action: Continuously monitor all workers
          executes: coordinate-workers task
          monitors:
            - Progress reports
            - Scope overlap reports
            - Blocker reports
            - Story completeness
          frequency: every_2_minutes
          
        - step: detect_scope_overlaps
          action: Identify duplicate or overlapping requirements
          strategies:
            minor_overlap: suggest_merge
            major_overlap: pause_and_escalate
            no_overlap: continue
            
        - step: validate_coverage
          action: Ensure all epic requirements are covered
          checks:
            - All requirements mapped to stories
            - No gaps in coverage
            - No orphaned requirements
          triggers:
            gap_detected: create_additional_story
            
        - step: cross_validate_consistency
          action: Ensure stories are consistent
          validates:
            - Consistent terminology
            - Consistent acceptance criteria format
            - Consistent technical approach
            - Valid dependencies
            
    - phase: aggregation
      agent: sm-coordinator
      steps:
        - step: collect_stories
          action: Gather all created stories
          executes: aggregate-results task
          collects:
            - Story files
            - Story metadata
            - Dependencies
            - Acceptance criteria
            
        - step: validate_epic_completeness
          action: Ensure epic is fully covered
          validates:
            - All requirements have stories
            - All stories are complete
            - Dependencies are valid
            - Numbering is correct
            
        - step: generate_epic_summary
          action: Create epic overview
          includes:
            - Total stories created
            - Epic coverage map
            - Dependency graph
            - Estimated effort
            - Next steps
            
  success_criteria:
    - All epic requirements covered
    - All stories complete and consistent
    - No scope overlaps
    - Dependencies valid
    - Story files created
    
  metrics:
    efficiency:
      sequential_estimate: story_count * 15_minutes
      parallel_actual: max(story_durations) + coordination_overhead
      time_saved: sequential_estimate - parallel_actual
      speedup_factor: sequential_estimate / parallel_actual
      
    quality:
      stories_created: count
      coverage_percentage: requirements_covered / total_requirements
      scope_overlaps_detected: count
      scope_overlaps_resolved: count
      
    coordination:
      workers_spawned: count
      conflicts_detected: count
      gaps_identified: count
      additional_stories_created: count
      
  example_usage: |
    User: @sm *explode-epic epic=user-authentication
    
    SM Agent transforms to sm-coordinator:
    
    === Epic Explosion Initiated ===
    Epic: User Authentication
    
    [Phase 1: Initialization]
    ✓ Loaded epic definition
    ✓ Identified 8 story boundaries:
      1.1 - User Login
      1.2 - User Registration
      1.3 - Password Reset
      1.4 - Email Verification
      1.5 - Two-Factor Authentication
      1.6 - Session Management
      1.7 - Logout
      1.8 - Account Deletion
    ✓ Validated parallelization possible
    ✓ Created execution plan
    
    [Phase 2: Worker Spawning]
    ✓ Spawned 8 sm-story-workers
    ✓ All workers initialized
    
    [Phase 3: Parallel Creation]
    Monitoring 8 workers...
    
    [Dashboard shows real-time progress]
    
    ⚠ Scope overlap detected: Stories 1.1 and 1.6 both mention session creation
    ✓ Auto-resolved: Clarified scope boundaries
    
    ✓ Coverage validated: All requirements covered
    ✓ Consistency validated: All stories follow template
    
    [Phase 4: Aggregation]
    ✓ Collected 8 stories
    ✓ Epic completeness validated
    ✓ Epic summary generated
    
    === Epic Explosion Complete ===
    Time: 15 minutes (vs 2 hours sequential)
    Speedup: 8x faster
    Stories Created: 8/8
    Coverage: 100%
    Quality: All stories complete and consistent
    
    Next Steps:
    - Review stories for approval
    - Create GitHub issues (*batch-issues)
    - Link stories to epic (*link-epic)
    - Begin development

