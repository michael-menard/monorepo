# <!-- Powered by BMADâ„¢ Core -->
# Completion Report Template
# Used by worker/specialist sub-agents to report task completion to coordinator

message_type: completion_report
version: 1.0

metadata:
  from_agent_id: "{{worker_id}}"
  from_agent_type: "{{worker_type}}"
  to_agent_id: "{{coordinator_id}}"
  to_agent_type: "{{coordinator_type}}"
  session_id: "{{session_id}}"
  timestamp: "{{timestamp}}"
  message_id: "{{message_id}}"
  in_reply_to: "{{task_assignment_message_id}}"

task_reference:
  task_id: "{{task_id}}"
  task_type: "{{task_type}}"
  work_item_id: "{{work_item_id}}"
  assigned_at: "{{assignment_timestamp}}"
  completed_at: "{{completion_timestamp}}"
  duration: "{{duration}}"

completion_status:
  status: "{{status}}"  # complete, partial, failed
  success_rate: "{{success_rate}}"  # 0-100%
  
  # If partial or failed
  incomplete_items:
    - item: "{{item_description}}"
      reason: "{{reason}}"
      
  failures:
    - failure: "{{failure_description}}"
      cause: "{{cause}}"
      attempted_resolutions: "{{resolutions_tried}}"

deliverables:
  artifacts_created:
    - path: "{{file_path}}"
      type: "{{file_type}}"  # source, test, documentation, configuration
      lines_of_code: "{{loc}}"
      description: "{{description}}"
      
  artifacts_modified:
    - path: "{{file_path}}"
      changes: "{{change_summary}}"
      lines_added: "{{added}}"
      lines_removed: "{{removed}}"
      
  artifacts_deleted:
    - path: "{{file_path}}"
      reason: "{{reason}}"
      
  documentation_updated:
    - path: "{{doc_path}}"
      updates: "{{update_description}}"

quality_assurance:
  tests:
    total_tests: "{{test_count}}"
    passing_tests: "{{passing_count}}"
    failing_tests: "{{failing_count}}"
    skipped_tests: "{{skipped_count}}"
    coverage_percentage: "{{coverage}}"
    
  code_quality:
    lint_status: "{{lint_status}}"  # passing, failing
    lint_errors: "{{lint_error_count}}"
    lint_warnings: "{{lint_warning_count}}"
    
  type_checking:
    type_check_status: "{{type_check_status}}"  # passing, failing
    type_errors: "{{type_error_count}}"
    
  build:
    build_status: "{{build_status}}"  # success, failed, not_run
    build_errors: "{{build_errors}}"

acceptance_criteria:
  criteria_met:
    - criterion: "{{criterion_description}}"
      status: "{{status}}"  # met, not_met, partially_met
      evidence: "{{evidence}}"
      
  overall_acceptance: "{{overall_status}}"  # accepted, needs_review, rejected

integration:
  git_operations:
    branch_created: "{{branch_name}}"
    commits: "{{commit_count}}"
    pull_request: "{{pr_url}}"
    
  dependencies_added:
    - package: "{{package_name}}"
      version: "{{version}}"
      reason: "{{reason}}"
      
  configuration_changes:
    - file: "{{config_file}}"
      changes: "{{changes}}"

summary:
  work_completed: "{{work_summary}}"
  challenges_encountered: "{{challenges}}"
  decisions_made: "{{decisions}}"
  assumptions: "{{assumptions}}"
  
recommendations:
  next_steps: "{{next_steps}}"
  follow_up_tasks: "{{follow_up}}"
  improvements: "{{improvement_suggestions}}"
  risks: "{{identified_risks}}"

handoff:
  ready_for: "{{next_agent}}"  # qa, user_review, deployment
  handoff_notes: "{{handoff_notes}}"
  review_focus_areas: "{{review_areas}}"
  known_limitations: "{{limitations}}"

metrics:
  time_spent: "{{time_spent}}"
  estimated_vs_actual: "{{variance}}"
  efficiency_notes: "{{efficiency_notes}}"

# Validation
validation:
  required_fields:
    - task_reference
    - completion_status
    - deliverables
    - quality_assurance
  optional_fields:
    - recommendations
    - handoff

